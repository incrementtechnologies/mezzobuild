{"version":3,"sources":["webpack:///./node_modules/node-forge/lib/pki.js","webpack:///./node_modules/node-forge/lib/prng.js","webpack:///./node_modules/node-forge/lib/random.js","webpack:///./node_modules/node-forge/lib/sha512.js","webpack:///./node_modules/node-forge/lib/prime.js","webpack:///./node_modules/node-forge/lib/sha1.js","webpack:///./node_modules/node-forge/lib/sha256.js","webpack:///./node_modules/node-forge/lib/rsa.js","webpack:///./node_modules/node-forge/lib/pss.js","webpack:///./node_modules/node-forge/lib/rc2.js"],"names":["forge","asn1","pki","module","exports","pemToDer","pem","msg","decode","procType","type","Error","util","createBuffer","body","privateKeyFromPem","error","headerType","obj","fromDer","privateKeyFromAsn1","privateKeyToPem","key","maxline","toDer","privateKeyToAsn1","getBytes","encode","privateKeyInfoToPem","_crypto","isNodejs","options","usePureJavaScript","process","versions","prng","create","plugin","ctx","seed","time","reseeds","generated","keyBytes","md","pools","Array","i","_reseed","callback","messageLength","_seed","needed","seedFile","err","bytes","collect","_reseedSync","seedFileSync","update","_2powK","k","digest","start","seedBytes","formatKey","formatSeed","defaultSeedFile","getRandomValues","globalScope","crypto","msCrypto","arr","b","length","count","Math","max","min","entropy","Uint32Array","floor","putInt32","e","QuotaExceededError","hi","lo","next","random","putByte","pool","generate","generateSync","cipher","increment","nextTick","putBytes","setImmediate","randomBytes","toString","substr","collectInt","n","x","String","fromCharCode","registerWorker","worker","self","listener","data","removeEventListener","addEventListener","postMessage","jQuery","prng_aes","_prng_aes_output","_prng_aes_buffer","spawnPrng","getBytesSync","tmp","getInt32","aes","_expandKey","_updateBlock","sha256","_ctx","window","document","Date","_navBytes","navigator","mousemove","clientX","clientY","keypress","charCode","createInstance","sha512","algorithms","sha384","sha224","algorithm","_initialized","_init","_states","_state","_h","_input","_w","wi","digestLength","replace","toLowerCase","blockLength","fullMessageLength","messageLengthSize","messageLength128","int32s","push","slice","encoding","encodeUtf8","len","_update","read","compact","finalBlock","carry","remaining","overflow","_padding","bits","h","hlen","rval","_k","fillString","s","w","t1_hi","t1_lo","t2_hi","t2_lo","s0_hi","s0_lo","s1_hi","s1_lo","ch_hi","ch_lo","maj_hi","maj_lo","a_hi","a_lo","b_hi","b_lo","c_hi","c_lo","d_hi","d_lo","e_hi","e_lo","f_hi","f_lo","g_hi","g_lo","h_hi","h_lo","w2","w7","w15","w16","prime","BigInteger","jsbn","GCD_30_DELTA","THIRTY","fromInt","op_or","y","generateProbablePrime","name","rng","nextBytes","charCodeAt","primeincFindPrime","primeincFindPrimeWithWorkers","primeincFindPrimeWithoutWorkers","num","generateRandom","deltaIdx","mrTests","getMillerRabinTests","bitLength","millerRabinTests","maxBlockTime","_primeinc","isProbablePrime","dAddOffset","Worker","numWorkers","workers","workLoad","range","workerScript","estimateCores","cores","workerMessage","found","terminate","hex","target","bits1","testBit","bitwiseTo","ONE","shiftLeft","mod","byteValue","sha1","messageLength64","h0","h1","h2","h3","h4","s2","t","a","c","d","f","h5","h6","h7","t1","t2","s0","s1","ch","maj","g","rsa","privateKeyValidator","tagClass","Class","UNIVERSAL","Type","SEQUENCE","constructed","value","INTEGER","capture","OID","OCTETSTRING","rsaPrivateKeyValidator","rsaPublicKeyValidator","publicKeyValidator","captureAsn1","BITSTRING","optional","digestInfoValidator","NULL","emsaPkcs1v15encode","oid","oids","oidBytes","oidToDer","digestInfo","digestAlgorithm","_modPow","pub","modPow","p","q","r","dP","subtract","dQ","qInv","modInverse","bytesToHex","compareTo","gcd","equals","multiply","xp","xq","add","_encodePkcs1_v1_5","m","bt","eb","ceil","padByte","padNum","numZeros","padBytes","_decodePkcs1_v1_5","em","ml","first","getByte","zero","_generateKeyPair","state","opts","getPrime","pBits","finish","qBits","p1","q1","phi","keys","privateKey","setPrivateKey","publicKey","setPublicKey","_bnToBytes","hexToBytes","_getMillerRabinTests","_detectNodeCrypto","fn","_detectSubtleCrypto","subtle","_detectSubtleMsCrypto","_intToUint8Array","buffer","Uint8Array","encrypt","toHex","yhex","ed","zeros","decrypt","expected","xhex","createKeyPairGenerationState","parseInt","eInt","pqState","stepKeyPairGenerationState","total","generateKeyPair","arguments","undefined","modulusLength","publicExponent","publicKeyEncoding","format","privateKeyEncoding","priv","publicKeyFromPem","generateKey","hash","then","pair","exportKey","pkcs8","setRsaPublicKey","genOp","oncomplete","result","exportOp","onerror","keypair","generateKeyPairSync","scheme","schemeOptions","toUpperCase","pkcs1","encode_rsa_oaep","indexOf","signature","_parseAllDigestBytes","verify","parseAllBytes","errors","validate","derToOid","algorithmIdentifier","md2","md5","setRsaPrivateKey","decode_rsa_oaep","wrapRsaPrivateKey","rsaKey","integerToDer","rsaEncryption","privateKeyModulus","privateKeyPublicExponent","privateKeyPrivateExponent","privateKeyPrime1","privateKeyPrime2","privateKeyExponent1","privateKeyExponent2","privateKeyCoefficient","privateKeyToRSAPrivateKey","publicKeyFromAsn1","publicKeyOid","rsaPublicKey","publicKeyModulus","publicKeyExponent","publicKeyToAsn1","publicKeyToSubjectPublicKeyInfo","publicKeyToRSAPublicKey","pss","mgf","saltLength","sLen","hLen","salt_","salt","pssobj","modBits","emBits","emLen","mHash","m_","ByteBuffer","fillWithByte","ps","db","maskLen","dbMask","maskedDB","mask","checkLen","h_","piTable","rol","word","ror","rc2","expandKey","effKeyBits","L","T","T1","T8","TM","at","setAt","createCipher","mixRound","mashRound","j","_finish","_output","_iv","K","getInt16Le","R","runPlan","plan","val","putInt16Le","ptr","ctr","iv","output","input","putBuffer","pad","padding","truncate","startEncrypting","createEncryptionCipher","startDecrypting","createDecryptionCipher"],"mappings":"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","file":"js/chunk-vendors~f53f0257.a29054c6.js","sourcesContent":["/**\n * Javascript implementation of a basic Public Key Infrastructure, including\n * support for RSA public and private keys.\n *\n * @author Dave Longley\n *\n * Copyright (c) 2010-2013 Digital Bazaar, Inc.\n */\nvar forge = require('./forge');\nrequire('./asn1');\nrequire('./oids');\nrequire('./pbe');\nrequire('./pem');\nrequire('./pbkdf2');\nrequire('./pkcs12');\nrequire('./pss');\nrequire('./rsa');\nrequire('./util');\nrequire('./x509');\n\n// shortcut for asn.1 API\nvar asn1 = forge.asn1;\n\n/* Public Key Infrastructure (PKI) implementation. */\nvar pki = module.exports = forge.pki = forge.pki || {};\n\n/**\n * NOTE: THIS METHOD IS DEPRECATED. Use pem.decode() instead.\n *\n * Converts PEM-formatted data to DER.\n *\n * @param pem the PEM-formatted data.\n *\n * @return the DER-formatted data.\n */\npki.pemToDer = function(pem) {\n  var msg = forge.pem.decode(pem)[0];\n  if(msg.procType && msg.procType.type === 'ENCRYPTED') {\n    throw new Error('Could not convert PEM to DER; PEM is encrypted.');\n  }\n  return forge.util.createBuffer(msg.body);\n};\n\n/**\n * Converts an RSA private key from PEM format.\n *\n * @param pem the PEM-formatted private key.\n *\n * @return the private key.\n */\npki.privateKeyFromPem = function(pem) {\n  var msg = forge.pem.decode(pem)[0];\n\n  if(msg.type !== 'PRIVATE KEY' && msg.type !== 'RSA PRIVATE KEY') {\n    var error = new Error('Could not convert private key from PEM; PEM ' +\n      'header type is not \"PRIVATE KEY\" or \"RSA PRIVATE KEY\".');\n    error.headerType = msg.type;\n    throw error;\n  }\n  if(msg.procType && msg.procType.type === 'ENCRYPTED') {\n    throw new Error('Could not convert private key from PEM; PEM is encrypted.');\n  }\n\n  // convert DER to ASN.1 object\n  var obj = asn1.fromDer(msg.body);\n\n  return pki.privateKeyFromAsn1(obj);\n};\n\n/**\n * Converts an RSA private key to PEM format.\n *\n * @param key the private key.\n * @param maxline the maximum characters per line, defaults to 64.\n *\n * @return the PEM-formatted private key.\n */\npki.privateKeyToPem = function(key, maxline) {\n  // convert to ASN.1, then DER, then PEM-encode\n  var msg = {\n    type: 'RSA PRIVATE KEY',\n    body: asn1.toDer(pki.privateKeyToAsn1(key)).getBytes()\n  };\n  return forge.pem.encode(msg, {maxline: maxline});\n};\n\n/**\n * Converts a PrivateKeyInfo to PEM format.\n *\n * @param pki the PrivateKeyInfo.\n * @param maxline the maximum characters per line, defaults to 64.\n *\n * @return the PEM-formatted private key.\n */\npki.privateKeyInfoToPem = function(pki, maxline) {\n  // convert to DER, then PEM-encode\n  var msg = {\n    type: 'PRIVATE KEY',\n    body: asn1.toDer(pki).getBytes()\n  };\n  return forge.pem.encode(msg, {maxline: maxline});\n};\n","/**\n * A javascript implementation of a cryptographically-secure\n * Pseudo Random Number Generator (PRNG). The Fortuna algorithm is followed\n * here though the use of SHA-256 is not enforced; when generating an\n * a PRNG context, the hashing algorithm and block cipher used for\n * the generator are specified via a plugin.\n *\n * @author Dave Longley\n *\n * Copyright (c) 2010-2014 Digital Bazaar, Inc.\n */\nvar forge = require('./forge');\nrequire('./util');\n\nvar _crypto = null;\nif(forge.util.isNodejs && !forge.options.usePureJavaScript &&\n  !process.versions['node-webkit']) {\n  _crypto = require('crypto');\n}\n\n/* PRNG API */\nvar prng = module.exports = forge.prng = forge.prng || {};\n\n/**\n * Creates a new PRNG context.\n *\n * A PRNG plugin must be passed in that will provide:\n *\n * 1. A function that initializes the key and seed of a PRNG context. It\n *   will be given a 16 byte key and a 16 byte seed. Any key expansion\n *   or transformation of the seed from a byte string into an array of\n *   integers (or similar) should be performed.\n * 2. The cryptographic function used by the generator. It takes a key and\n *   a seed.\n * 3. A seed increment function. It takes the seed and returns seed + 1.\n * 4. An api to create a message digest.\n *\n * For an example, see random.js.\n *\n * @param plugin the PRNG plugin to use.\n */\nprng.create = function(plugin) {\n  var ctx = {\n    plugin: plugin,\n    key: null,\n    seed: null,\n    time: null,\n    // number of reseeds so far\n    reseeds: 0,\n    // amount of data generated so far\n    generated: 0,\n    // no initial key bytes\n    keyBytes: ''\n  };\n\n  // create 32 entropy pools (each is a message digest)\n  var md = plugin.md;\n  var pools = new Array(32);\n  for(var i = 0; i < 32; ++i) {\n    pools[i] = md.create();\n  }\n  ctx.pools = pools;\n\n  // entropy pools are written to cyclically, starting at index 0\n  ctx.pool = 0;\n\n  /**\n   * Generates random bytes. The bytes may be generated synchronously or\n   * asynchronously. Web workers must use the asynchronous interface or\n   * else the behavior is undefined.\n   *\n   * @param count the number of random bytes to generate.\n   * @param [callback(err, bytes)] called once the operation completes.\n   *\n   * @return count random bytes as a string.\n   */\n  ctx.generate = function(count, callback) {\n    // do synchronously\n    if(!callback) {\n      return ctx.generateSync(count);\n    }\n\n    // simple generator using counter-based CBC\n    var cipher = ctx.plugin.cipher;\n    var increment = ctx.plugin.increment;\n    var formatKey = ctx.plugin.formatKey;\n    var formatSeed = ctx.plugin.formatSeed;\n    var b = forge.util.createBuffer();\n\n    // paranoid deviation from Fortuna:\n    // reset key for every request to protect previously\n    // generated random bytes should the key be discovered;\n    // there is no 100ms based reseeding because of this\n    // forced reseed for every `generate` call\n    ctx.key = null;\n\n    generate();\n\n    function generate(err) {\n      if(err) {\n        return callback(err);\n      }\n\n      // sufficient bytes generated\n      if(b.length() >= count) {\n        return callback(null, b.getBytes(count));\n      }\n\n      // if amount of data generated is greater than 1 MiB, trigger reseed\n      if(ctx.generated > 0xfffff) {\n        ctx.key = null;\n      }\n\n      if(ctx.key === null) {\n        // prevent stack overflow\n        return forge.util.nextTick(function() {\n          _reseed(generate);\n        });\n      }\n\n      // generate the random bytes\n      var bytes = cipher(ctx.key, ctx.seed);\n      ctx.generated += bytes.length;\n      b.putBytes(bytes);\n\n      // generate bytes for a new key and seed\n      ctx.key = formatKey(cipher(ctx.key, increment(ctx.seed)));\n      ctx.seed = formatSeed(cipher(ctx.key, ctx.seed));\n\n      forge.util.setImmediate(generate);\n    }\n  };\n\n  /**\n   * Generates random bytes synchronously.\n   *\n   * @param count the number of random bytes to generate.\n   *\n   * @return count random bytes as a string.\n   */\n  ctx.generateSync = function(count) {\n    // simple generator using counter-based CBC\n    var cipher = ctx.plugin.cipher;\n    var increment = ctx.plugin.increment;\n    var formatKey = ctx.plugin.formatKey;\n    var formatSeed = ctx.plugin.formatSeed;\n\n    // paranoid deviation from Fortuna:\n    // reset key for every request to protect previously\n    // generated random bytes should the key be discovered;\n    // there is no 100ms based reseeding because of this\n    // forced reseed for every `generateSync` call\n    ctx.key = null;\n\n    var b = forge.util.createBuffer();\n    while(b.length() < count) {\n      // if amount of data generated is greater than 1 MiB, trigger reseed\n      if(ctx.generated > 0xfffff) {\n        ctx.key = null;\n      }\n\n      if(ctx.key === null) {\n        _reseedSync();\n      }\n\n      // generate the random bytes\n      var bytes = cipher(ctx.key, ctx.seed);\n      ctx.generated += bytes.length;\n      b.putBytes(bytes);\n\n      // generate bytes for a new key and seed\n      ctx.key = formatKey(cipher(ctx.key, increment(ctx.seed)));\n      ctx.seed = formatSeed(cipher(ctx.key, ctx.seed));\n    }\n\n    return b.getBytes(count);\n  };\n\n  /**\n   * Private function that asynchronously reseeds a generator.\n   *\n   * @param callback(err) called once the operation completes.\n   */\n  function _reseed(callback) {\n    if(ctx.pools[0].messageLength >= 32) {\n      _seed();\n      return callback();\n    }\n    // not enough seed data...\n    var needed = (32 - ctx.pools[0].messageLength) << 5;\n    ctx.seedFile(needed, function(err, bytes) {\n      if(err) {\n        return callback(err);\n      }\n      ctx.collect(bytes);\n      _seed();\n      callback();\n    });\n  }\n\n  /**\n   * Private function that synchronously reseeds a generator.\n   */\n  function _reseedSync() {\n    if(ctx.pools[0].messageLength >= 32) {\n      return _seed();\n    }\n    // not enough seed data...\n    var needed = (32 - ctx.pools[0].messageLength) << 5;\n    ctx.collect(ctx.seedFileSync(needed));\n    _seed();\n  }\n\n  /**\n   * Private function that seeds a generator once enough bytes are available.\n   */\n  function _seed() {\n    // update reseed count\n    ctx.reseeds = (ctx.reseeds === 0xffffffff) ? 0 : ctx.reseeds + 1;\n\n    // goal is to update `key` via:\n    // key = hash(key + s)\n    //   where 's' is all collected entropy from selected pools, then...\n\n    // create a plugin-based message digest\n    var md = ctx.plugin.md.create();\n\n    // consume current key bytes\n    md.update(ctx.keyBytes);\n\n    // digest the entropy of pools whose index k meet the\n    // condition 'n mod 2^k == 0' where n is the number of reseeds\n    var _2powK = 1;\n    for(var k = 0; k < 32; ++k) {\n      if(ctx.reseeds % _2powK === 0) {\n        md.update(ctx.pools[k].digest().getBytes());\n        ctx.pools[k].start();\n      }\n      _2powK = _2powK << 1;\n    }\n\n    // get digest for key bytes\n    ctx.keyBytes = md.digest().getBytes();\n\n    // paranoid deviation from Fortuna:\n    // update `seed` via `seed = hash(key)`\n    // instead of initializing to zero once and only\n    // ever incrementing it\n    md.start();\n    md.update(ctx.keyBytes);\n    var seedBytes = md.digest().getBytes();\n\n    // update state\n    ctx.key = ctx.plugin.formatKey(ctx.keyBytes);\n    ctx.seed = ctx.plugin.formatSeed(seedBytes);\n    ctx.generated = 0;\n  }\n\n  /**\n   * The built-in default seedFile. This seedFile is used when entropy\n   * is needed immediately.\n   *\n   * @param needed the number of bytes that are needed.\n   *\n   * @return the random bytes.\n   */\n  function defaultSeedFile(needed) {\n    // use window.crypto.getRandomValues strong source of entropy if available\n    var getRandomValues = null;\n    var globalScope = forge.util.globalScope;\n    var _crypto = globalScope.crypto || globalScope.msCrypto;\n    if(_crypto && _crypto.getRandomValues) {\n      getRandomValues = function(arr) {\n        return _crypto.getRandomValues(arr);\n      };\n    }\n\n    var b = forge.util.createBuffer();\n    if(getRandomValues) {\n      while(b.length() < needed) {\n        // max byte length is 65536 before QuotaExceededError is thrown\n        // http://www.w3.org/TR/WebCryptoAPI/#RandomSource-method-getRandomValues\n        var count = Math.max(1, Math.min(needed - b.length(), 65536) / 4);\n        var entropy = new Uint32Array(Math.floor(count));\n        try {\n          getRandomValues(entropy);\n          for(var i = 0; i < entropy.length; ++i) {\n            b.putInt32(entropy[i]);\n          }\n        } catch(e) {\n          /* only ignore QuotaExceededError */\n          if(!(typeof QuotaExceededError !== 'undefined' &&\n            e instanceof QuotaExceededError)) {\n            throw e;\n          }\n        }\n      }\n    }\n\n    // be sad and add some weak random data\n    if(b.length() < needed) {\n      /* Draws from Park-Miller \"minimal standard\" 31 bit PRNG,\n      implemented with David G. Carta's optimization: with 32 bit math\n      and without division (Public Domain). */\n      var hi, lo, next;\n      var seed = Math.floor(Math.random() * 0x010000);\n      while(b.length() < needed) {\n        lo = 16807 * (seed & 0xFFFF);\n        hi = 16807 * (seed >> 16);\n        lo += (hi & 0x7FFF) << 16;\n        lo += hi >> 15;\n        lo = (lo & 0x7FFFFFFF) + (lo >> 31);\n        seed = lo & 0xFFFFFFFF;\n\n        // consume lower 3 bytes of seed\n        for(var i = 0; i < 3; ++i) {\n          // throw in more pseudo random\n          next = seed >>> (i << 3);\n          next ^= Math.floor(Math.random() * 0x0100);\n          b.putByte(next & 0xFF);\n        }\n      }\n    }\n\n    return b.getBytes(needed);\n  }\n  // initialize seed file APIs\n  if(_crypto) {\n    // use nodejs async API\n    ctx.seedFile = function(needed, callback) {\n      _crypto.randomBytes(needed, function(err, bytes) {\n        if(err) {\n          return callback(err);\n        }\n        callback(null, bytes.toString());\n      });\n    };\n    // use nodejs sync API\n    ctx.seedFileSync = function(needed) {\n      return _crypto.randomBytes(needed).toString();\n    };\n  } else {\n    ctx.seedFile = function(needed, callback) {\n      try {\n        callback(null, defaultSeedFile(needed));\n      } catch(e) {\n        callback(e);\n      }\n    };\n    ctx.seedFileSync = defaultSeedFile;\n  }\n\n  /**\n   * Adds entropy to a prng ctx's accumulator.\n   *\n   * @param bytes the bytes of entropy as a string.\n   */\n  ctx.collect = function(bytes) {\n    // iterate over pools distributing entropy cyclically\n    var count = bytes.length;\n    for(var i = 0; i < count; ++i) {\n      ctx.pools[ctx.pool].update(bytes.substr(i, 1));\n      ctx.pool = (ctx.pool === 31) ? 0 : ctx.pool + 1;\n    }\n  };\n\n  /**\n   * Collects an integer of n bits.\n   *\n   * @param i the integer entropy.\n   * @param n the number of bits in the integer.\n   */\n  ctx.collectInt = function(i, n) {\n    var bytes = '';\n    for(var x = 0; x < n; x += 8) {\n      bytes += String.fromCharCode((i >> x) & 0xFF);\n    }\n    ctx.collect(bytes);\n  };\n\n  /**\n   * Registers a Web Worker to receive immediate entropy from the main thread.\n   * This method is required until Web Workers can access the native crypto\n   * API. This method should be called twice for each created worker, once in\n   * the main thread, and once in the worker itself.\n   *\n   * @param worker the worker to register.\n   */\n  ctx.registerWorker = function(worker) {\n    // worker receives random bytes\n    if(worker === self) {\n      ctx.seedFile = function(needed, callback) {\n        function listener(e) {\n          var data = e.data;\n          if(data.forge && data.forge.prng) {\n            self.removeEventListener('message', listener);\n            callback(data.forge.prng.err, data.forge.prng.bytes);\n          }\n        }\n        self.addEventListener('message', listener);\n        self.postMessage({forge: {prng: {needed: needed}}});\n      };\n    } else {\n      // main thread sends random bytes upon request\n      var listener = function(e) {\n        var data = e.data;\n        if(data.forge && data.forge.prng) {\n          ctx.seedFile(data.forge.prng.needed, function(err, bytes) {\n            worker.postMessage({forge: {prng: {err: err, bytes: bytes}}});\n          });\n        }\n      };\n      // TODO: do we need to remove the event listener when the worker dies?\n      worker.addEventListener('message', listener);\n    }\n  };\n\n  return ctx;\n};\n","/**\n * An API for getting cryptographically-secure random bytes. The bytes are\n * generated using the Fortuna algorithm devised by Bruce Schneier and\n * Niels Ferguson.\n *\n * Getting strong random bytes is not yet easy to do in javascript. The only\n * truish random entropy that can be collected is from the mouse, keyboard, or\n * from timing with respect to page loads, etc. This generator makes a poor\n * attempt at providing random bytes when those sources haven't yet provided\n * enough entropy to initially seed or to reseed the PRNG.\n *\n * @author Dave Longley\n *\n * Copyright (c) 2009-2014 Digital Bazaar, Inc.\n */\nvar forge = require('./forge');\nrequire('./aes');\nrequire('./sha256');\nrequire('./prng');\nrequire('./util');\n\n(function() {\n\n// forge.random already defined\nif(forge.random && forge.random.getBytes) {\n  module.exports = forge.random;\n  return;\n}\n\n(function(jQuery) {\n\n// the default prng plugin, uses AES-128\nvar prng_aes = {};\nvar _prng_aes_output = new Array(4);\nvar _prng_aes_buffer = forge.util.createBuffer();\nprng_aes.formatKey = function(key) {\n  // convert the key into 32-bit integers\n  var tmp = forge.util.createBuffer(key);\n  key = new Array(4);\n  key[0] = tmp.getInt32();\n  key[1] = tmp.getInt32();\n  key[2] = tmp.getInt32();\n  key[3] = tmp.getInt32();\n\n  // return the expanded key\n  return forge.aes._expandKey(key, false);\n};\nprng_aes.formatSeed = function(seed) {\n  // convert seed into 32-bit integers\n  var tmp = forge.util.createBuffer(seed);\n  seed = new Array(4);\n  seed[0] = tmp.getInt32();\n  seed[1] = tmp.getInt32();\n  seed[2] = tmp.getInt32();\n  seed[3] = tmp.getInt32();\n  return seed;\n};\nprng_aes.cipher = function(key, seed) {\n  forge.aes._updateBlock(key, seed, _prng_aes_output, false);\n  _prng_aes_buffer.putInt32(_prng_aes_output[0]);\n  _prng_aes_buffer.putInt32(_prng_aes_output[1]);\n  _prng_aes_buffer.putInt32(_prng_aes_output[2]);\n  _prng_aes_buffer.putInt32(_prng_aes_output[3]);\n  return _prng_aes_buffer.getBytes();\n};\nprng_aes.increment = function(seed) {\n  // FIXME: do we care about carry or signed issues?\n  ++seed[3];\n  return seed;\n};\nprng_aes.md = forge.md.sha256;\n\n/**\n * Creates a new PRNG.\n */\nfunction spawnPrng() {\n  var ctx = forge.prng.create(prng_aes);\n\n  /**\n   * Gets random bytes. If a native secure crypto API is unavailable, this\n   * method tries to make the bytes more unpredictable by drawing from data that\n   * can be collected from the user of the browser, eg: mouse movement.\n   *\n   * If a callback is given, this method will be called asynchronously.\n   *\n   * @param count the number of random bytes to get.\n   * @param [callback(err, bytes)] called once the operation completes.\n   *\n   * @return the random bytes in a string.\n   */\n  ctx.getBytes = function(count, callback) {\n    return ctx.generate(count, callback);\n  };\n\n  /**\n   * Gets random bytes asynchronously. If a native secure crypto API is\n   * unavailable, this method tries to make the bytes more unpredictable by\n   * drawing from data that can be collected from the user of the browser,\n   * eg: mouse movement.\n   *\n   * @param count the number of random bytes to get.\n   *\n   * @return the random bytes in a string.\n   */\n  ctx.getBytesSync = function(count) {\n    return ctx.generate(count);\n  };\n\n  return ctx;\n}\n\n// create default prng context\nvar _ctx = spawnPrng();\n\n// add other sources of entropy only if window.crypto.getRandomValues is not\n// available -- otherwise this source will be automatically used by the prng\nvar getRandomValues = null;\nvar globalScope = forge.util.globalScope;\nvar _crypto = globalScope.crypto || globalScope.msCrypto;\nif(_crypto && _crypto.getRandomValues) {\n  getRandomValues = function(arr) {\n    return _crypto.getRandomValues(arr);\n  };\n}\n\nif(forge.options.usePureJavaScript ||\n  (!forge.util.isNodejs && !getRandomValues)) {\n  // if this is a web worker, do not use weak entropy, instead register to\n  // receive strong entropy asynchronously from the main thread\n  if(typeof window === 'undefined' || window.document === undefined) {\n    // FIXME:\n  }\n\n  // get load time entropy\n  _ctx.collectInt(+new Date(), 32);\n\n  // add some entropy from navigator object\n  if(typeof(navigator) !== 'undefined') {\n    var _navBytes = '';\n    for(var key in navigator) {\n      try {\n        if(typeof(navigator[key]) == 'string') {\n          _navBytes += navigator[key];\n        }\n      } catch(e) {\n        /* Some navigator keys might not be accessible, e.g. the geolocation\n          attribute throws an exception if touched in Mozilla chrome://\n          context.\n\n          Silently ignore this and just don't use this as a source of\n          entropy. */\n      }\n    }\n    _ctx.collect(_navBytes);\n    _navBytes = null;\n  }\n\n  // add mouse and keyboard collectors if jquery is available\n  if(jQuery) {\n    // set up mouse entropy capture\n    jQuery().mousemove(function(e) {\n      // add mouse coords\n      _ctx.collectInt(e.clientX, 16);\n      _ctx.collectInt(e.clientY, 16);\n    });\n\n    // set up keyboard entropy capture\n    jQuery().keypress(function(e) {\n      _ctx.collectInt(e.charCode, 8);\n    });\n  }\n}\n\n/* Random API */\nif(!forge.random) {\n  forge.random = _ctx;\n} else {\n  // extend forge.random with _ctx\n  for(var key in _ctx) {\n    forge.random[key] = _ctx[key];\n  }\n}\n\n// expose spawn PRNG\nforge.random.createInstance = spawnPrng;\n\nmodule.exports = forge.random;\n\n})(typeof(jQuery) !== 'undefined' ? jQuery : null);\n\n})();\n","/**\n * Secure Hash Algorithm with a 1024-bit block size implementation.\n *\n * This includes: SHA-512, SHA-384, SHA-512/224, and SHA-512/256. For\n * SHA-256 (block size 512 bits), see sha256.js.\n *\n * See FIPS 180-4 for details.\n *\n * @author Dave Longley\n *\n * Copyright (c) 2014-2015 Digital Bazaar, Inc.\n */\nvar forge = require('./forge');\nrequire('./md');\nrequire('./util');\n\nvar sha512 = module.exports = forge.sha512 = forge.sha512 || {};\n\n// SHA-512\nforge.md.sha512 = forge.md.algorithms.sha512 = sha512;\n\n// SHA-384\nvar sha384 = forge.sha384 = forge.sha512.sha384 = forge.sha512.sha384 || {};\nsha384.create = function() {\n  return sha512.create('SHA-384');\n};\nforge.md.sha384 = forge.md.algorithms.sha384 = sha384;\n\n// SHA-512/256\nforge.sha512.sha256 = forge.sha512.sha256 || {\n  create: function() {\n    return sha512.create('SHA-512/256');\n  }\n};\nforge.md['sha512/256'] = forge.md.algorithms['sha512/256'] =\n  forge.sha512.sha256;\n\n// SHA-512/224\nforge.sha512.sha224 = forge.sha512.sha224 || {\n  create: function() {\n    return sha512.create('SHA-512/224');\n  }\n};\nforge.md['sha512/224'] = forge.md.algorithms['sha512/224'] =\n  forge.sha512.sha224;\n\n/**\n * Creates a SHA-2 message digest object.\n *\n * @param algorithm the algorithm to use (SHA-512, SHA-384, SHA-512/224,\n *          SHA-512/256).\n *\n * @return a message digest object.\n */\nsha512.create = function(algorithm) {\n  // do initialization as necessary\n  if(!_initialized) {\n    _init();\n  }\n\n  if(typeof algorithm === 'undefined') {\n    algorithm = 'SHA-512';\n  }\n\n  if(!(algorithm in _states)) {\n    throw new Error('Invalid SHA-512 algorithm: ' + algorithm);\n  }\n\n  // SHA-512 state contains eight 64-bit integers (each as two 32-bit ints)\n  var _state = _states[algorithm];\n  var _h = null;\n\n  // input buffer\n  var _input = forge.util.createBuffer();\n\n  // used for 64-bit word storage\n  var _w = new Array(80);\n  for(var wi = 0; wi < 80; ++wi) {\n    _w[wi] = new Array(2);\n  }\n\n  // determine digest length by algorithm name (default)\n  var digestLength = 64;\n  switch(algorithm) {\n    case 'SHA-384':\n      digestLength = 48;\n      break;\n    case 'SHA-512/256':\n      digestLength = 32;\n      break;\n    case 'SHA-512/224':\n      digestLength = 28;\n      break;\n  }\n\n  // message digest object\n  var md = {\n    // SHA-512 => sha512\n    algorithm: algorithm.replace('-', '').toLowerCase(),\n    blockLength: 128,\n    digestLength: digestLength,\n    // 56-bit length of message so far (does not including padding)\n    messageLength: 0,\n    // true message length\n    fullMessageLength: null,\n    // size of message length in bytes\n    messageLengthSize: 16\n  };\n\n  /**\n   * Starts the digest.\n   *\n   * @return this digest object.\n   */\n  md.start = function() {\n    // up to 56-bit message length for convenience\n    md.messageLength = 0;\n\n    // full message length (set md.messageLength128 for backwards-compatibility)\n    md.fullMessageLength = md.messageLength128 = [];\n    var int32s = md.messageLengthSize / 4;\n    for(var i = 0; i < int32s; ++i) {\n      md.fullMessageLength.push(0);\n    }\n    _input = forge.util.createBuffer();\n    _h = new Array(_state.length);\n    for(var i = 0; i < _state.length; ++i) {\n      _h[i] = _state[i].slice(0);\n    }\n    return md;\n  };\n  // start digest automatically for first time\n  md.start();\n\n  /**\n   * Updates the digest with the given message input. The given input can\n   * treated as raw input (no encoding will be applied) or an encoding of\n   * 'utf8' maybe given to encode the input using UTF-8.\n   *\n   * @param msg the message input to update with.\n   * @param encoding the encoding to use (default: 'raw', other: 'utf8').\n   *\n   * @return this digest object.\n   */\n  md.update = function(msg, encoding) {\n    if(encoding === 'utf8') {\n      msg = forge.util.encodeUtf8(msg);\n    }\n\n    // update message length\n    var len = msg.length;\n    md.messageLength += len;\n    len = [(len / 0x100000000) >>> 0, len >>> 0];\n    for(var i = md.fullMessageLength.length - 1; i >= 0; --i) {\n      md.fullMessageLength[i] += len[1];\n      len[1] = len[0] + ((md.fullMessageLength[i] / 0x100000000) >>> 0);\n      md.fullMessageLength[i] = md.fullMessageLength[i] >>> 0;\n      len[0] = ((len[1] / 0x100000000) >>> 0);\n    }\n\n    // add bytes to input buffer\n    _input.putBytes(msg);\n\n    // process bytes\n    _update(_h, _w, _input);\n\n    // compact input buffer every 2K or if empty\n    if(_input.read > 2048 || _input.length() === 0) {\n      _input.compact();\n    }\n\n    return md;\n  };\n\n  /**\n   * Produces the digest.\n   *\n   * @return a byte buffer containing the digest value.\n   */\n  md.digest = function() {\n    /* Note: Here we copy the remaining bytes in the input buffer and\n    add the appropriate SHA-512 padding. Then we do the final update\n    on a copy of the state so that if the user wants to get\n    intermediate digests they can do so. */\n\n    /* Determine the number of bytes that must be added to the message\n    to ensure its length is congruent to 896 mod 1024. In other words,\n    the data to be digested must be a multiple of 1024 bits (or 128 bytes).\n    This data includes the message, some padding, and the length of the\n    message. Since the length of the message will be encoded as 16 bytes (128\n    bits), that means that the last segment of the data must have 112 bytes\n    (896 bits) of message and padding. Therefore, the length of the message\n    plus the padding must be congruent to 896 mod 1024 because\n    1024 - 128 = 896.\n\n    In order to fill up the message length it must be filled with\n    padding that begins with 1 bit followed by all 0 bits. Padding\n    must *always* be present, so if the message length is already\n    congruent to 896 mod 1024, then 1024 padding bits must be added. */\n\n    var finalBlock = forge.util.createBuffer();\n    finalBlock.putBytes(_input.bytes());\n\n    // compute remaining size to be digested (include message length size)\n    var remaining = (\n      md.fullMessageLength[md.fullMessageLength.length - 1] +\n      md.messageLengthSize);\n\n    // add padding for overflow blockSize - overflow\n    // _padding starts with 1 byte with first bit is set (byte value 128), then\n    // there may be up to (blockSize - 1) other pad bytes\n    var overflow = remaining & (md.blockLength - 1);\n    finalBlock.putBytes(_padding.substr(0, md.blockLength - overflow));\n\n    // serialize message length in bits in big-endian order; since length\n    // is stored in bytes we multiply by 8 and add carry from next int\n    var next, carry;\n    var bits = md.fullMessageLength[0] * 8;\n    for(var i = 0; i < md.fullMessageLength.length - 1; ++i) {\n      next = md.fullMessageLength[i + 1] * 8;\n      carry = (next / 0x100000000) >>> 0;\n      bits += carry;\n      finalBlock.putInt32(bits >>> 0);\n      bits = next >>> 0;\n    }\n    finalBlock.putInt32(bits);\n\n    var h = new Array(_h.length);\n    for(var i = 0; i < _h.length; ++i) {\n      h[i] = _h[i].slice(0);\n    }\n    _update(h, _w, finalBlock);\n    var rval = forge.util.createBuffer();\n    var hlen;\n    if(algorithm === 'SHA-512') {\n      hlen = h.length;\n    } else if(algorithm === 'SHA-384') {\n      hlen = h.length - 2;\n    } else {\n      hlen = h.length - 4;\n    }\n    for(var i = 0; i < hlen; ++i) {\n      rval.putInt32(h[i][0]);\n      if(i !== hlen - 1 || algorithm !== 'SHA-512/224') {\n        rval.putInt32(h[i][1]);\n      }\n    }\n    return rval;\n  };\n\n  return md;\n};\n\n// sha-512 padding bytes not initialized yet\nvar _padding = null;\nvar _initialized = false;\n\n// table of constants\nvar _k = null;\n\n// initial hash states\nvar _states = null;\n\n/**\n * Initializes the constant tables.\n */\nfunction _init() {\n  // create padding\n  _padding = String.fromCharCode(128);\n  _padding += forge.util.fillString(String.fromCharCode(0x00), 128);\n\n  // create K table for SHA-512\n  _k = [\n    [0x428a2f98, 0xd728ae22], [0x71374491, 0x23ef65cd],\n    [0xb5c0fbcf, 0xec4d3b2f], [0xe9b5dba5, 0x8189dbbc],\n    [0x3956c25b, 0xf348b538], [0x59f111f1, 0xb605d019],\n    [0x923f82a4, 0xaf194f9b], [0xab1c5ed5, 0xda6d8118],\n    [0xd807aa98, 0xa3030242], [0x12835b01, 0x45706fbe],\n    [0x243185be, 0x4ee4b28c], [0x550c7dc3, 0xd5ffb4e2],\n    [0x72be5d74, 0xf27b896f], [0x80deb1fe, 0x3b1696b1],\n    [0x9bdc06a7, 0x25c71235], [0xc19bf174, 0xcf692694],\n    [0xe49b69c1, 0x9ef14ad2], [0xefbe4786, 0x384f25e3],\n    [0x0fc19dc6, 0x8b8cd5b5], [0x240ca1cc, 0x77ac9c65],\n    [0x2de92c6f, 0x592b0275], [0x4a7484aa, 0x6ea6e483],\n    [0x5cb0a9dc, 0xbd41fbd4], [0x76f988da, 0x831153b5],\n    [0x983e5152, 0xee66dfab], [0xa831c66d, 0x2db43210],\n    [0xb00327c8, 0x98fb213f], [0xbf597fc7, 0xbeef0ee4],\n    [0xc6e00bf3, 0x3da88fc2], [0xd5a79147, 0x930aa725],\n    [0x06ca6351, 0xe003826f], [0x14292967, 0x0a0e6e70],\n    [0x27b70a85, 0x46d22ffc], [0x2e1b2138, 0x5c26c926],\n    [0x4d2c6dfc, 0x5ac42aed], [0x53380d13, 0x9d95b3df],\n    [0x650a7354, 0x8baf63de], [0x766a0abb, 0x3c77b2a8],\n    [0x81c2c92e, 0x47edaee6], [0x92722c85, 0x1482353b],\n    [0xa2bfe8a1, 0x4cf10364], [0xa81a664b, 0xbc423001],\n    [0xc24b8b70, 0xd0f89791], [0xc76c51a3, 0x0654be30],\n    [0xd192e819, 0xd6ef5218], [0xd6990624, 0x5565a910],\n    [0xf40e3585, 0x5771202a], [0x106aa070, 0x32bbd1b8],\n    [0x19a4c116, 0xb8d2d0c8], [0x1e376c08, 0x5141ab53],\n    [0x2748774c, 0xdf8eeb99], [0x34b0bcb5, 0xe19b48a8],\n    [0x391c0cb3, 0xc5c95a63], [0x4ed8aa4a, 0xe3418acb],\n    [0x5b9cca4f, 0x7763e373], [0x682e6ff3, 0xd6b2b8a3],\n    [0x748f82ee, 0x5defb2fc], [0x78a5636f, 0x43172f60],\n    [0x84c87814, 0xa1f0ab72], [0x8cc70208, 0x1a6439ec],\n    [0x90befffa, 0x23631e28], [0xa4506ceb, 0xde82bde9],\n    [0xbef9a3f7, 0xb2c67915], [0xc67178f2, 0xe372532b],\n    [0xca273ece, 0xea26619c], [0xd186b8c7, 0x21c0c207],\n    [0xeada7dd6, 0xcde0eb1e], [0xf57d4f7f, 0xee6ed178],\n    [0x06f067aa, 0x72176fba], [0x0a637dc5, 0xa2c898a6],\n    [0x113f9804, 0xbef90dae], [0x1b710b35, 0x131c471b],\n    [0x28db77f5, 0x23047d84], [0x32caab7b, 0x40c72493],\n    [0x3c9ebe0a, 0x15c9bebc], [0x431d67c4, 0x9c100d4c],\n    [0x4cc5d4be, 0xcb3e42b6], [0x597f299c, 0xfc657e2a],\n    [0x5fcb6fab, 0x3ad6faec], [0x6c44198c, 0x4a475817]\n  ];\n\n  // initial hash states\n  _states = {};\n  _states['SHA-512'] = [\n    [0x6a09e667, 0xf3bcc908],\n    [0xbb67ae85, 0x84caa73b],\n    [0x3c6ef372, 0xfe94f82b],\n    [0xa54ff53a, 0x5f1d36f1],\n    [0x510e527f, 0xade682d1],\n    [0x9b05688c, 0x2b3e6c1f],\n    [0x1f83d9ab, 0xfb41bd6b],\n    [0x5be0cd19, 0x137e2179]\n  ];\n  _states['SHA-384'] = [\n    [0xcbbb9d5d, 0xc1059ed8],\n    [0x629a292a, 0x367cd507],\n    [0x9159015a, 0x3070dd17],\n    [0x152fecd8, 0xf70e5939],\n    [0x67332667, 0xffc00b31],\n    [0x8eb44a87, 0x68581511],\n    [0xdb0c2e0d, 0x64f98fa7],\n    [0x47b5481d, 0xbefa4fa4]\n  ];\n  _states['SHA-512/256'] = [\n    [0x22312194, 0xFC2BF72C],\n    [0x9F555FA3, 0xC84C64C2],\n    [0x2393B86B, 0x6F53B151],\n    [0x96387719, 0x5940EABD],\n    [0x96283EE2, 0xA88EFFE3],\n    [0xBE5E1E25, 0x53863992],\n    [0x2B0199FC, 0x2C85B8AA],\n    [0x0EB72DDC, 0x81C52CA2]\n  ];\n  _states['SHA-512/224'] = [\n    [0x8C3D37C8, 0x19544DA2],\n    [0x73E19966, 0x89DCD4D6],\n    [0x1DFAB7AE, 0x32FF9C82],\n    [0x679DD514, 0x582F9FCF],\n    [0x0F6D2B69, 0x7BD44DA8],\n    [0x77E36F73, 0x04C48942],\n    [0x3F9D85A8, 0x6A1D36C8],\n    [0x1112E6AD, 0x91D692A1]\n  ];\n\n  // now initialized\n  _initialized = true;\n}\n\n/**\n * Updates a SHA-512 state with the given byte buffer.\n *\n * @param s the SHA-512 state to update.\n * @param w the array to use to store words.\n * @param bytes the byte buffer to update with.\n */\nfunction _update(s, w, bytes) {\n  // consume 512 bit (128 byte) chunks\n  var t1_hi, t1_lo;\n  var t2_hi, t2_lo;\n  var s0_hi, s0_lo;\n  var s1_hi, s1_lo;\n  var ch_hi, ch_lo;\n  var maj_hi, maj_lo;\n  var a_hi, a_lo;\n  var b_hi, b_lo;\n  var c_hi, c_lo;\n  var d_hi, d_lo;\n  var e_hi, e_lo;\n  var f_hi, f_lo;\n  var g_hi, g_lo;\n  var h_hi, h_lo;\n  var i, hi, lo, w2, w7, w15, w16;\n  var len = bytes.length();\n  while(len >= 128) {\n    // the w array will be populated with sixteen 64-bit big-endian words\n    // and then extended into 64 64-bit words according to SHA-512\n    for(i = 0; i < 16; ++i) {\n      w[i][0] = bytes.getInt32() >>> 0;\n      w[i][1] = bytes.getInt32() >>> 0;\n    }\n    for(; i < 80; ++i) {\n      // for word 2 words ago: ROTR 19(x) ^ ROTR 61(x) ^ SHR 6(x)\n      w2 = w[i - 2];\n      hi = w2[0];\n      lo = w2[1];\n\n      // high bits\n      t1_hi = (\n        ((hi >>> 19) | (lo << 13)) ^ // ROTR 19\n        ((lo >>> 29) | (hi << 3)) ^ // ROTR 61/(swap + ROTR 29)\n        (hi >>> 6)) >>> 0; // SHR 6\n      // low bits\n      t1_lo = (\n        ((hi << 13) | (lo >>> 19)) ^ // ROTR 19\n        ((lo << 3) | (hi >>> 29)) ^ // ROTR 61/(swap + ROTR 29)\n        ((hi << 26) | (lo >>> 6))) >>> 0; // SHR 6\n\n      // for word 15 words ago: ROTR 1(x) ^ ROTR 8(x) ^ SHR 7(x)\n      w15 = w[i - 15];\n      hi = w15[0];\n      lo = w15[1];\n\n      // high bits\n      t2_hi = (\n        ((hi >>> 1) | (lo << 31)) ^ // ROTR 1\n        ((hi >>> 8) | (lo << 24)) ^ // ROTR 8\n        (hi >>> 7)) >>> 0; // SHR 7\n      // low bits\n      t2_lo = (\n        ((hi << 31) | (lo >>> 1)) ^ // ROTR 1\n        ((hi << 24) | (lo >>> 8)) ^ // ROTR 8\n        ((hi << 25) | (lo >>> 7))) >>> 0; // SHR 7\n\n      // sum(t1, word 7 ago, t2, word 16 ago) modulo 2^64 (carry lo overflow)\n      w7 = w[i - 7];\n      w16 = w[i - 16];\n      lo = (t1_lo + w7[1] + t2_lo + w16[1]);\n      w[i][0] = (t1_hi + w7[0] + t2_hi + w16[0] +\n        ((lo / 0x100000000) >>> 0)) >>> 0;\n      w[i][1] = lo >>> 0;\n    }\n\n    // initialize hash value for this chunk\n    a_hi = s[0][0];\n    a_lo = s[0][1];\n    b_hi = s[1][0];\n    b_lo = s[1][1];\n    c_hi = s[2][0];\n    c_lo = s[2][1];\n    d_hi = s[3][0];\n    d_lo = s[3][1];\n    e_hi = s[4][0];\n    e_lo = s[4][1];\n    f_hi = s[5][0];\n    f_lo = s[5][1];\n    g_hi = s[6][0];\n    g_lo = s[6][1];\n    h_hi = s[7][0];\n    h_lo = s[7][1];\n\n    // round function\n    for(i = 0; i < 80; ++i) {\n      // Sum1(e) = ROTR 14(e) ^ ROTR 18(e) ^ ROTR 41(e)\n      s1_hi = (\n        ((e_hi >>> 14) | (e_lo << 18)) ^ // ROTR 14\n        ((e_hi >>> 18) | (e_lo << 14)) ^ // ROTR 18\n        ((e_lo >>> 9) | (e_hi << 23))) >>> 0; // ROTR 41/(swap + ROTR 9)\n      s1_lo = (\n        ((e_hi << 18) | (e_lo >>> 14)) ^ // ROTR 14\n        ((e_hi << 14) | (e_lo >>> 18)) ^ // ROTR 18\n        ((e_lo << 23) | (e_hi >>> 9))) >>> 0; // ROTR 41/(swap + ROTR 9)\n\n      // Ch(e, f, g) (optimized the same way as SHA-1)\n      ch_hi = (g_hi ^ (e_hi & (f_hi ^ g_hi))) >>> 0;\n      ch_lo = (g_lo ^ (e_lo & (f_lo ^ g_lo))) >>> 0;\n\n      // Sum0(a) = ROTR 28(a) ^ ROTR 34(a) ^ ROTR 39(a)\n      s0_hi = (\n        ((a_hi >>> 28) | (a_lo << 4)) ^ // ROTR 28\n        ((a_lo >>> 2) | (a_hi << 30)) ^ // ROTR 34/(swap + ROTR 2)\n        ((a_lo >>> 7) | (a_hi << 25))) >>> 0; // ROTR 39/(swap + ROTR 7)\n      s0_lo = (\n        ((a_hi << 4) | (a_lo >>> 28)) ^ // ROTR 28\n        ((a_lo << 30) | (a_hi >>> 2)) ^ // ROTR 34/(swap + ROTR 2)\n        ((a_lo << 25) | (a_hi >>> 7))) >>> 0; // ROTR 39/(swap + ROTR 7)\n\n      // Maj(a, b, c) (optimized the same way as SHA-1)\n      maj_hi = ((a_hi & b_hi) | (c_hi & (a_hi ^ b_hi))) >>> 0;\n      maj_lo = ((a_lo & b_lo) | (c_lo & (a_lo ^ b_lo))) >>> 0;\n\n      // main algorithm\n      // t1 = (h + s1 + ch + _k[i] + _w[i]) modulo 2^64 (carry lo overflow)\n      lo = (h_lo + s1_lo + ch_lo + _k[i][1] + w[i][1]);\n      t1_hi = (h_hi + s1_hi + ch_hi + _k[i][0] + w[i][0] +\n        ((lo / 0x100000000) >>> 0)) >>> 0;\n      t1_lo = lo >>> 0;\n\n      // t2 = s0 + maj modulo 2^64 (carry lo overflow)\n      lo = s0_lo + maj_lo;\n      t2_hi = (s0_hi + maj_hi + ((lo / 0x100000000) >>> 0)) >>> 0;\n      t2_lo = lo >>> 0;\n\n      h_hi = g_hi;\n      h_lo = g_lo;\n\n      g_hi = f_hi;\n      g_lo = f_lo;\n\n      f_hi = e_hi;\n      f_lo = e_lo;\n\n      // e = (d + t1) modulo 2^64 (carry lo overflow)\n      lo = d_lo + t1_lo;\n      e_hi = (d_hi + t1_hi + ((lo / 0x100000000) >>> 0)) >>> 0;\n      e_lo = lo >>> 0;\n\n      d_hi = c_hi;\n      d_lo = c_lo;\n\n      c_hi = b_hi;\n      c_lo = b_lo;\n\n      b_hi = a_hi;\n      b_lo = a_lo;\n\n      // a = (t1 + t2) modulo 2^64 (carry lo overflow)\n      lo = t1_lo + t2_lo;\n      a_hi = (t1_hi + t2_hi + ((lo / 0x100000000) >>> 0)) >>> 0;\n      a_lo = lo >>> 0;\n    }\n\n    // update hash state (additional modulo 2^64)\n    lo = s[0][1] + a_lo;\n    s[0][0] = (s[0][0] + a_hi + ((lo / 0x100000000) >>> 0)) >>> 0;\n    s[0][1] = lo >>> 0;\n\n    lo = s[1][1] + b_lo;\n    s[1][0] = (s[1][0] + b_hi + ((lo / 0x100000000) >>> 0)) >>> 0;\n    s[1][1] = lo >>> 0;\n\n    lo = s[2][1] + c_lo;\n    s[2][0] = (s[2][0] + c_hi + ((lo / 0x100000000) >>> 0)) >>> 0;\n    s[2][1] = lo >>> 0;\n\n    lo = s[3][1] + d_lo;\n    s[3][0] = (s[3][0] + d_hi + ((lo / 0x100000000) >>> 0)) >>> 0;\n    s[3][1] = lo >>> 0;\n\n    lo = s[4][1] + e_lo;\n    s[4][0] = (s[4][0] + e_hi + ((lo / 0x100000000) >>> 0)) >>> 0;\n    s[4][1] = lo >>> 0;\n\n    lo = s[5][1] + f_lo;\n    s[5][0] = (s[5][0] + f_hi + ((lo / 0x100000000) >>> 0)) >>> 0;\n    s[5][1] = lo >>> 0;\n\n    lo = s[6][1] + g_lo;\n    s[6][0] = (s[6][0] + g_hi + ((lo / 0x100000000) >>> 0)) >>> 0;\n    s[6][1] = lo >>> 0;\n\n    lo = s[7][1] + h_lo;\n    s[7][0] = (s[7][0] + h_hi + ((lo / 0x100000000) >>> 0)) >>> 0;\n    s[7][1] = lo >>> 0;\n\n    len -= 128;\n  }\n}\n","/**\n * Prime number generation API.\n *\n * @author Dave Longley\n *\n * Copyright (c) 2014 Digital Bazaar, Inc.\n */\nvar forge = require('./forge');\nrequire('./util');\nrequire('./jsbn');\nrequire('./random');\n\n(function() {\n\n// forge.prime already defined\nif(forge.prime) {\n  module.exports = forge.prime;\n  return;\n}\n\n/* PRIME API */\nvar prime = module.exports = forge.prime = forge.prime || {};\n\nvar BigInteger = forge.jsbn.BigInteger;\n\n// primes are 30k+i for i = 1, 7, 11, 13, 17, 19, 23, 29\nvar GCD_30_DELTA = [6, 4, 2, 4, 2, 4, 6, 2];\nvar THIRTY = new BigInteger(null);\nTHIRTY.fromInt(30);\nvar op_or = function(x, y) {return x|y;};\n\n/**\n * Generates a random probable prime with the given number of bits.\n *\n * Alternative algorithms can be specified by name as a string or as an\n * object with custom options like so:\n *\n * {\n *   name: 'PRIMEINC',\n *   options: {\n *     maxBlockTime: <the maximum amount of time to block the main\n *       thread before allowing I/O other JS to run>,\n *     millerRabinTests: <the number of miller-rabin tests to run>,\n *     workerScript: <the worker script URL>,\n *     workers: <the number of web workers (if supported) to use,\n *       -1 to use estimated cores minus one>.\n *     workLoad: the size of the work load, ie: number of possible prime\n *       numbers for each web worker to check per work assignment,\n *       (default: 100).\n *   }\n * }\n *\n * @param bits the number of bits for the prime number.\n * @param options the options to use.\n *          [algorithm] the algorithm to use (default: 'PRIMEINC').\n *          [prng] a custom crypto-secure pseudo-random number generator to use,\n *            that must define \"getBytesSync\".\n *\n * @return callback(err, num) called once the operation completes.\n */\nprime.generateProbablePrime = function(bits, options, callback) {\n  if(typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n  options = options || {};\n\n  // default to PRIMEINC algorithm\n  var algorithm = options.algorithm || 'PRIMEINC';\n  if(typeof algorithm === 'string') {\n    algorithm = {name: algorithm};\n  }\n  algorithm.options = algorithm.options || {};\n\n  // create prng with api that matches BigInteger secure random\n  var prng = options.prng || forge.random;\n  var rng = {\n    // x is an array to fill with bytes\n    nextBytes: function(x) {\n      var b = prng.getBytesSync(x.length);\n      for(var i = 0; i < x.length; ++i) {\n        x[i] = b.charCodeAt(i);\n      }\n    }\n  };\n\n  if(algorithm.name === 'PRIMEINC') {\n    return primeincFindPrime(bits, rng, algorithm.options, callback);\n  }\n\n  throw new Error('Invalid prime generation algorithm: ' + algorithm.name);\n};\n\nfunction primeincFindPrime(bits, rng, options, callback) {\n  if('workers' in options) {\n    return primeincFindPrimeWithWorkers(bits, rng, options, callback);\n  }\n  return primeincFindPrimeWithoutWorkers(bits, rng, options, callback);\n}\n\nfunction primeincFindPrimeWithoutWorkers(bits, rng, options, callback) {\n  // initialize random number\n  var num = generateRandom(bits, rng);\n\n  /* Note: All primes are of the form 30k+i for i < 30 and gcd(30, i)=1. The\n  number we are given is always aligned at 30k + 1. Each time the number is\n  determined not to be prime we add to get to the next 'i', eg: if the number\n  was at 30k + 1 we add 6. */\n  var deltaIdx = 0;\n\n  // get required number of MR tests\n  var mrTests = getMillerRabinTests(num.bitLength());\n  if('millerRabinTests' in options) {\n    mrTests = options.millerRabinTests;\n  }\n\n  // find prime nearest to 'num' for maxBlockTime ms\n  // 10 ms gives 5ms of leeway for other calculations before dropping\n  // below 60fps (1000/60 == 16.67), but in reality, the number will\n  // likely be higher due to an 'atomic' big int modPow\n  var maxBlockTime = 10;\n  if('maxBlockTime' in options) {\n    maxBlockTime = options.maxBlockTime;\n  }\n\n  _primeinc(num, bits, rng, deltaIdx, mrTests, maxBlockTime, callback);\n}\n\nfunction _primeinc(num, bits, rng, deltaIdx, mrTests, maxBlockTime, callback) {\n  var start = +new Date();\n  do {\n    // overflow, regenerate random number\n    if(num.bitLength() > bits) {\n      num = generateRandom(bits, rng);\n    }\n    // do primality test\n    if(num.isProbablePrime(mrTests)) {\n      return callback(null, num);\n    }\n    // get next potential prime\n    num.dAddOffset(GCD_30_DELTA[deltaIdx++ % 8], 0);\n  } while(maxBlockTime < 0 || (+new Date() - start < maxBlockTime));\n\n  // keep trying later\n  forge.util.setImmediate(function() {\n    _primeinc(num, bits, rng, deltaIdx, mrTests, maxBlockTime, callback);\n  });\n}\n\n// NOTE: This algorithm is indeterminate in nature because workers\n// run in parallel looking at different segments of numbers. Even if this\n// algorithm is run twice with the same input from a predictable RNG, it\n// may produce different outputs.\nfunction primeincFindPrimeWithWorkers(bits, rng, options, callback) {\n  // web workers unavailable\n  if(typeof Worker === 'undefined') {\n    return primeincFindPrimeWithoutWorkers(bits, rng, options, callback);\n  }\n\n  // initialize random number\n  var num = generateRandom(bits, rng);\n\n  // use web workers to generate keys\n  var numWorkers = options.workers;\n  var workLoad = options.workLoad || 100;\n  var range = workLoad * 30 / 8;\n  var workerScript = options.workerScript || 'forge/prime.worker.js';\n  if(numWorkers === -1) {\n    return forge.util.estimateCores(function(err, cores) {\n      if(err) {\n        // default to 2\n        cores = 2;\n      }\n      numWorkers = cores - 1;\n      generate();\n    });\n  }\n  generate();\n\n  function generate() {\n    // require at least 1 worker\n    numWorkers = Math.max(1, numWorkers);\n\n    // TODO: consider optimizing by starting workers outside getPrime() ...\n    // note that in order to clean up they will have to be made internally\n    // asynchronous which may actually be slower\n\n    // start workers immediately\n    var workers = [];\n    for(var i = 0; i < numWorkers; ++i) {\n      // FIXME: fix path or use blob URLs\n      workers[i] = new Worker(workerScript);\n    }\n    var running = numWorkers;\n\n    // listen for requests from workers and assign ranges to find prime\n    for(var i = 0; i < numWorkers; ++i) {\n      workers[i].addEventListener('message', workerMessage);\n    }\n\n    /* Note: The distribution of random numbers is unknown. Therefore, each\n    web worker is continuously allocated a range of numbers to check for a\n    random number until one is found.\n\n    Every 30 numbers will be checked just 8 times, because prime numbers\n    have the form:\n\n    30k+i, for i < 30 and gcd(30, i)=1 (there are 8 values of i for this)\n\n    Therefore, if we want a web worker to run N checks before asking for\n    a new range of numbers, each range must contain N*30/8 numbers.\n\n    For 100 checks (workLoad), this is a range of 375. */\n\n    var found = false;\n    function workerMessage(e) {\n      // ignore message, prime already found\n      if(found) {\n        return;\n      }\n\n      --running;\n      var data = e.data;\n      if(data.found) {\n        // terminate all workers\n        for(var i = 0; i < workers.length; ++i) {\n          workers[i].terminate();\n        }\n        found = true;\n        return callback(null, new BigInteger(data.prime, 16));\n      }\n\n      // overflow, regenerate random number\n      if(num.bitLength() > bits) {\n        num = generateRandom(bits, rng);\n      }\n\n      // assign new range to check\n      var hex = num.toString(16);\n\n      // start prime search\n      e.target.postMessage({\n        hex: hex,\n        workLoad: workLoad\n      });\n\n      num.dAddOffset(range, 0);\n    }\n  }\n}\n\n/**\n * Generates a random number using the given number of bits and RNG.\n *\n * @param bits the number of bits for the number.\n * @param rng the random number generator to use.\n *\n * @return the random number.\n */\nfunction generateRandom(bits, rng) {\n  var num = new BigInteger(bits, rng);\n  // force MSB set\n  var bits1 = bits - 1;\n  if(!num.testBit(bits1)) {\n    num.bitwiseTo(BigInteger.ONE.shiftLeft(bits1), op_or, num);\n  }\n  // align number on 30k+1 boundary\n  num.dAddOffset(31 - num.mod(THIRTY).byteValue(), 0);\n  return num;\n}\n\n/**\n * Returns the required number of Miller-Rabin tests to generate a\n * prime with an error probability of (1/2)^80.\n *\n * See Handbook of Applied Cryptography Chapter 4, Table 4.4.\n *\n * @param bits the bit size.\n *\n * @return the required number of iterations.\n */\nfunction getMillerRabinTests(bits) {\n  if(bits <= 100) return 27;\n  if(bits <= 150) return 18;\n  if(bits <= 200) return 15;\n  if(bits <= 250) return 12;\n  if(bits <= 300) return 9;\n  if(bits <= 350) return 8;\n  if(bits <= 400) return 7;\n  if(bits <= 500) return 6;\n  if(bits <= 600) return 5;\n  if(bits <= 800) return 4;\n  if(bits <= 1250) return 3;\n  return 2;\n}\n\n})();\n","/**\n * Secure Hash Algorithm with 160-bit digest (SHA-1) implementation.\n *\n * @author Dave Longley\n *\n * Copyright (c) 2010-2015 Digital Bazaar, Inc.\n */\nvar forge = require('./forge');\nrequire('./md');\nrequire('./util');\n\nvar sha1 = module.exports = forge.sha1 = forge.sha1 || {};\nforge.md.sha1 = forge.md.algorithms.sha1 = sha1;\n\n/**\n * Creates a SHA-1 message digest object.\n *\n * @return a message digest object.\n */\nsha1.create = function() {\n  // do initialization as necessary\n  if(!_initialized) {\n    _init();\n  }\n\n  // SHA-1 state contains five 32-bit integers\n  var _state = null;\n\n  // input buffer\n  var _input = forge.util.createBuffer();\n\n  // used for word storage\n  var _w = new Array(80);\n\n  // message digest object\n  var md = {\n    algorithm: 'sha1',\n    blockLength: 64,\n    digestLength: 20,\n    // 56-bit length of message so far (does not including padding)\n    messageLength: 0,\n    // true message length\n    fullMessageLength: null,\n    // size of message length in bytes\n    messageLengthSize: 8\n  };\n\n  /**\n   * Starts the digest.\n   *\n   * @return this digest object.\n   */\n  md.start = function() {\n    // up to 56-bit message length for convenience\n    md.messageLength = 0;\n\n    // full message length (set md.messageLength64 for backwards-compatibility)\n    md.fullMessageLength = md.messageLength64 = [];\n    var int32s = md.messageLengthSize / 4;\n    for(var i = 0; i < int32s; ++i) {\n      md.fullMessageLength.push(0);\n    }\n    _input = forge.util.createBuffer();\n    _state = {\n      h0: 0x67452301,\n      h1: 0xEFCDAB89,\n      h2: 0x98BADCFE,\n      h3: 0x10325476,\n      h4: 0xC3D2E1F0\n    };\n    return md;\n  };\n  // start digest automatically for first time\n  md.start();\n\n  /**\n   * Updates the digest with the given message input. The given input can\n   * treated as raw input (no encoding will be applied) or an encoding of\n   * 'utf8' maybe given to encode the input using UTF-8.\n   *\n   * @param msg the message input to update with.\n   * @param encoding the encoding to use (default: 'raw', other: 'utf8').\n   *\n   * @return this digest object.\n   */\n  md.update = function(msg, encoding) {\n    if(encoding === 'utf8') {\n      msg = forge.util.encodeUtf8(msg);\n    }\n\n    // update message length\n    var len = msg.length;\n    md.messageLength += len;\n    len = [(len / 0x100000000) >>> 0, len >>> 0];\n    for(var i = md.fullMessageLength.length - 1; i >= 0; --i) {\n      md.fullMessageLength[i] += len[1];\n      len[1] = len[0] + ((md.fullMessageLength[i] / 0x100000000) >>> 0);\n      md.fullMessageLength[i] = md.fullMessageLength[i] >>> 0;\n      len[0] = ((len[1] / 0x100000000) >>> 0);\n    }\n\n    // add bytes to input buffer\n    _input.putBytes(msg);\n\n    // process bytes\n    _update(_state, _w, _input);\n\n    // compact input buffer every 2K or if empty\n    if(_input.read > 2048 || _input.length() === 0) {\n      _input.compact();\n    }\n\n    return md;\n  };\n\n  /**\n   * Produces the digest.\n   *\n   * @return a byte buffer containing the digest value.\n   */\n  md.digest = function() {\n    /* Note: Here we copy the remaining bytes in the input buffer and\n    add the appropriate SHA-1 padding. Then we do the final update\n    on a copy of the state so that if the user wants to get\n    intermediate digests they can do so. */\n\n    /* Determine the number of bytes that must be added to the message\n    to ensure its length is congruent to 448 mod 512. In other words,\n    the data to be digested must be a multiple of 512 bits (or 128 bytes).\n    This data includes the message, some padding, and the length of the\n    message. Since the length of the message will be encoded as 8 bytes (64\n    bits), that means that the last segment of the data must have 56 bytes\n    (448 bits) of message and padding. Therefore, the length of the message\n    plus the padding must be congruent to 448 mod 512 because\n    512 - 128 = 448.\n\n    In order to fill up the message length it must be filled with\n    padding that begins with 1 bit followed by all 0 bits. Padding\n    must *always* be present, so if the message length is already\n    congruent to 448 mod 512, then 512 padding bits must be added. */\n\n    var finalBlock = forge.util.createBuffer();\n    finalBlock.putBytes(_input.bytes());\n\n    // compute remaining size to be digested (include message length size)\n    var remaining = (\n      md.fullMessageLength[md.fullMessageLength.length - 1] +\n      md.messageLengthSize);\n\n    // add padding for overflow blockSize - overflow\n    // _padding starts with 1 byte with first bit is set (byte value 128), then\n    // there may be up to (blockSize - 1) other pad bytes\n    var overflow = remaining & (md.blockLength - 1);\n    finalBlock.putBytes(_padding.substr(0, md.blockLength - overflow));\n\n    // serialize message length in bits in big-endian order; since length\n    // is stored in bytes we multiply by 8 and add carry from next int\n    var next, carry;\n    var bits = md.fullMessageLength[0] * 8;\n    for(var i = 0; i < md.fullMessageLength.length - 1; ++i) {\n      next = md.fullMessageLength[i + 1] * 8;\n      carry = (next / 0x100000000) >>> 0;\n      bits += carry;\n      finalBlock.putInt32(bits >>> 0);\n      bits = next >>> 0;\n    }\n    finalBlock.putInt32(bits);\n\n    var s2 = {\n      h0: _state.h0,\n      h1: _state.h1,\n      h2: _state.h2,\n      h3: _state.h3,\n      h4: _state.h4\n    };\n    _update(s2, _w, finalBlock);\n    var rval = forge.util.createBuffer();\n    rval.putInt32(s2.h0);\n    rval.putInt32(s2.h1);\n    rval.putInt32(s2.h2);\n    rval.putInt32(s2.h3);\n    rval.putInt32(s2.h4);\n    return rval;\n  };\n\n  return md;\n};\n\n// sha-1 padding bytes not initialized yet\nvar _padding = null;\nvar _initialized = false;\n\n/**\n * Initializes the constant tables.\n */\nfunction _init() {\n  // create padding\n  _padding = String.fromCharCode(128);\n  _padding += forge.util.fillString(String.fromCharCode(0x00), 64);\n\n  // now initialized\n  _initialized = true;\n}\n\n/**\n * Updates a SHA-1 state with the given byte buffer.\n *\n * @param s the SHA-1 state to update.\n * @param w the array to use to store words.\n * @param bytes the byte buffer to update with.\n */\nfunction _update(s, w, bytes) {\n  // consume 512 bit (64 byte) chunks\n  var t, a, b, c, d, e, f, i;\n  var len = bytes.length();\n  while(len >= 64) {\n    // the w array will be populated with sixteen 32-bit big-endian words\n    // and then extended into 80 32-bit words according to SHA-1 algorithm\n    // and for 32-79 using Max Locktyukhin's optimization\n\n    // initialize hash value for this chunk\n    a = s.h0;\n    b = s.h1;\n    c = s.h2;\n    d = s.h3;\n    e = s.h4;\n\n    // round 1\n    for(i = 0; i < 16; ++i) {\n      t = bytes.getInt32();\n      w[i] = t;\n      f = d ^ (b & (c ^ d));\n      t = ((a << 5) | (a >>> 27)) + f + e + 0x5A827999 + t;\n      e = d;\n      d = c;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      c = ((b << 30) | (b >>> 2)) >>> 0;\n      b = a;\n      a = t;\n    }\n    for(; i < 20; ++i) {\n      t = (w[i - 3] ^ w[i - 8] ^ w[i - 14] ^ w[i - 16]);\n      t = (t << 1) | (t >>> 31);\n      w[i] = t;\n      f = d ^ (b & (c ^ d));\n      t = ((a << 5) | (a >>> 27)) + f + e + 0x5A827999 + t;\n      e = d;\n      d = c;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      c = ((b << 30) | (b >>> 2)) >>> 0;\n      b = a;\n      a = t;\n    }\n    // round 2\n    for(; i < 32; ++i) {\n      t = (w[i - 3] ^ w[i - 8] ^ w[i - 14] ^ w[i - 16]);\n      t = (t << 1) | (t >>> 31);\n      w[i] = t;\n      f = b ^ c ^ d;\n      t = ((a << 5) | (a >>> 27)) + f + e + 0x6ED9EBA1 + t;\n      e = d;\n      d = c;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      c = ((b << 30) | (b >>> 2)) >>> 0;\n      b = a;\n      a = t;\n    }\n    for(; i < 40; ++i) {\n      t = (w[i - 6] ^ w[i - 16] ^ w[i - 28] ^ w[i - 32]);\n      t = (t << 2) | (t >>> 30);\n      w[i] = t;\n      f = b ^ c ^ d;\n      t = ((a << 5) | (a >>> 27)) + f + e + 0x6ED9EBA1 + t;\n      e = d;\n      d = c;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      c = ((b << 30) | (b >>> 2)) >>> 0;\n      b = a;\n      a = t;\n    }\n    // round 3\n    for(; i < 60; ++i) {\n      t = (w[i - 6] ^ w[i - 16] ^ w[i - 28] ^ w[i - 32]);\n      t = (t << 2) | (t >>> 30);\n      w[i] = t;\n      f = (b & c) | (d & (b ^ c));\n      t = ((a << 5) | (a >>> 27)) + f + e + 0x8F1BBCDC + t;\n      e = d;\n      d = c;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      c = ((b << 30) | (b >>> 2)) >>> 0;\n      b = a;\n      a = t;\n    }\n    // round 4\n    for(; i < 80; ++i) {\n      t = (w[i - 6] ^ w[i - 16] ^ w[i - 28] ^ w[i - 32]);\n      t = (t << 2) | (t >>> 30);\n      w[i] = t;\n      f = b ^ c ^ d;\n      t = ((a << 5) | (a >>> 27)) + f + e + 0xCA62C1D6 + t;\n      e = d;\n      d = c;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      c = ((b << 30) | (b >>> 2)) >>> 0;\n      b = a;\n      a = t;\n    }\n\n    // update hash state\n    s.h0 = (s.h0 + a) | 0;\n    s.h1 = (s.h1 + b) | 0;\n    s.h2 = (s.h2 + c) | 0;\n    s.h3 = (s.h3 + d) | 0;\n    s.h4 = (s.h4 + e) | 0;\n\n    len -= 64;\n  }\n}\n","/**\n * Secure Hash Algorithm with 256-bit digest (SHA-256) implementation.\n *\n * See FIPS 180-2 for details.\n *\n * @author Dave Longley\n *\n * Copyright (c) 2010-2015 Digital Bazaar, Inc.\n */\nvar forge = require('./forge');\nrequire('./md');\nrequire('./util');\n\nvar sha256 = module.exports = forge.sha256 = forge.sha256 || {};\nforge.md.sha256 = forge.md.algorithms.sha256 = sha256;\n\n/**\n * Creates a SHA-256 message digest object.\n *\n * @return a message digest object.\n */\nsha256.create = function() {\n  // do initialization as necessary\n  if(!_initialized) {\n    _init();\n  }\n\n  // SHA-256 state contains eight 32-bit integers\n  var _state = null;\n\n  // input buffer\n  var _input = forge.util.createBuffer();\n\n  // used for word storage\n  var _w = new Array(64);\n\n  // message digest object\n  var md = {\n    algorithm: 'sha256',\n    blockLength: 64,\n    digestLength: 32,\n    // 56-bit length of message so far (does not including padding)\n    messageLength: 0,\n    // true message length\n    fullMessageLength: null,\n    // size of message length in bytes\n    messageLengthSize: 8\n  };\n\n  /**\n   * Starts the digest.\n   *\n   * @return this digest object.\n   */\n  md.start = function() {\n    // up to 56-bit message length for convenience\n    md.messageLength = 0;\n\n    // full message length (set md.messageLength64 for backwards-compatibility)\n    md.fullMessageLength = md.messageLength64 = [];\n    var int32s = md.messageLengthSize / 4;\n    for(var i = 0; i < int32s; ++i) {\n      md.fullMessageLength.push(0);\n    }\n    _input = forge.util.createBuffer();\n    _state = {\n      h0: 0x6A09E667,\n      h1: 0xBB67AE85,\n      h2: 0x3C6EF372,\n      h3: 0xA54FF53A,\n      h4: 0x510E527F,\n      h5: 0x9B05688C,\n      h6: 0x1F83D9AB,\n      h7: 0x5BE0CD19\n    };\n    return md;\n  };\n  // start digest automatically for first time\n  md.start();\n\n  /**\n   * Updates the digest with the given message input. The given input can\n   * treated as raw input (no encoding will be applied) or an encoding of\n   * 'utf8' maybe given to encode the input using UTF-8.\n   *\n   * @param msg the message input to update with.\n   * @param encoding the encoding to use (default: 'raw', other: 'utf8').\n   *\n   * @return this digest object.\n   */\n  md.update = function(msg, encoding) {\n    if(encoding === 'utf8') {\n      msg = forge.util.encodeUtf8(msg);\n    }\n\n    // update message length\n    var len = msg.length;\n    md.messageLength += len;\n    len = [(len / 0x100000000) >>> 0, len >>> 0];\n    for(var i = md.fullMessageLength.length - 1; i >= 0; --i) {\n      md.fullMessageLength[i] += len[1];\n      len[1] = len[0] + ((md.fullMessageLength[i] / 0x100000000) >>> 0);\n      md.fullMessageLength[i] = md.fullMessageLength[i] >>> 0;\n      len[0] = ((len[1] / 0x100000000) >>> 0);\n    }\n\n    // add bytes to input buffer\n    _input.putBytes(msg);\n\n    // process bytes\n    _update(_state, _w, _input);\n\n    // compact input buffer every 2K or if empty\n    if(_input.read > 2048 || _input.length() === 0) {\n      _input.compact();\n    }\n\n    return md;\n  };\n\n  /**\n   * Produces the digest.\n   *\n   * @return a byte buffer containing the digest value.\n   */\n  md.digest = function() {\n    /* Note: Here we copy the remaining bytes in the input buffer and\n    add the appropriate SHA-256 padding. Then we do the final update\n    on a copy of the state so that if the user wants to get\n    intermediate digests they can do so. */\n\n    /* Determine the number of bytes that must be added to the message\n    to ensure its length is congruent to 448 mod 512. In other words,\n    the data to be digested must be a multiple of 512 bits (or 128 bytes).\n    This data includes the message, some padding, and the length of the\n    message. Since the length of the message will be encoded as 8 bytes (64\n    bits), that means that the last segment of the data must have 56 bytes\n    (448 bits) of message and padding. Therefore, the length of the message\n    plus the padding must be congruent to 448 mod 512 because\n    512 - 128 = 448.\n\n    In order to fill up the message length it must be filled with\n    padding that begins with 1 bit followed by all 0 bits. Padding\n    must *always* be present, so if the message length is already\n    congruent to 448 mod 512, then 512 padding bits must be added. */\n\n    var finalBlock = forge.util.createBuffer();\n    finalBlock.putBytes(_input.bytes());\n\n    // compute remaining size to be digested (include message length size)\n    var remaining = (\n      md.fullMessageLength[md.fullMessageLength.length - 1] +\n      md.messageLengthSize);\n\n    // add padding for overflow blockSize - overflow\n    // _padding starts with 1 byte with first bit is set (byte value 128), then\n    // there may be up to (blockSize - 1) other pad bytes\n    var overflow = remaining & (md.blockLength - 1);\n    finalBlock.putBytes(_padding.substr(0, md.blockLength - overflow));\n\n    // serialize message length in bits in big-endian order; since length\n    // is stored in bytes we multiply by 8 and add carry from next int\n    var next, carry;\n    var bits = md.fullMessageLength[0] * 8;\n    for(var i = 0; i < md.fullMessageLength.length - 1; ++i) {\n      next = md.fullMessageLength[i + 1] * 8;\n      carry = (next / 0x100000000) >>> 0;\n      bits += carry;\n      finalBlock.putInt32(bits >>> 0);\n      bits = next >>> 0;\n    }\n    finalBlock.putInt32(bits);\n\n    var s2 = {\n      h0: _state.h0,\n      h1: _state.h1,\n      h2: _state.h2,\n      h3: _state.h3,\n      h4: _state.h4,\n      h5: _state.h5,\n      h6: _state.h6,\n      h7: _state.h7\n    };\n    _update(s2, _w, finalBlock);\n    var rval = forge.util.createBuffer();\n    rval.putInt32(s2.h0);\n    rval.putInt32(s2.h1);\n    rval.putInt32(s2.h2);\n    rval.putInt32(s2.h3);\n    rval.putInt32(s2.h4);\n    rval.putInt32(s2.h5);\n    rval.putInt32(s2.h6);\n    rval.putInt32(s2.h7);\n    return rval;\n  };\n\n  return md;\n};\n\n// sha-256 padding bytes not initialized yet\nvar _padding = null;\nvar _initialized = false;\n\n// table of constants\nvar _k = null;\n\n/**\n * Initializes the constant tables.\n */\nfunction _init() {\n  // create padding\n  _padding = String.fromCharCode(128);\n  _padding += forge.util.fillString(String.fromCharCode(0x00), 64);\n\n  // create K table for SHA-256\n  _k = [\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5,\n    0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3,\n    0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc,\n    0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7,\n    0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13,\n    0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3,\n    0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5,\n    0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208,\n    0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2];\n\n  // now initialized\n  _initialized = true;\n}\n\n/**\n * Updates a SHA-256 state with the given byte buffer.\n *\n * @param s the SHA-256 state to update.\n * @param w the array to use to store words.\n * @param bytes the byte buffer to update with.\n */\nfunction _update(s, w, bytes) {\n  // consume 512 bit (64 byte) chunks\n  var t1, t2, s0, s1, ch, maj, i, a, b, c, d, e, f, g, h;\n  var len = bytes.length();\n  while(len >= 64) {\n    // the w array will be populated with sixteen 32-bit big-endian words\n    // and then extended into 64 32-bit words according to SHA-256\n    for(i = 0; i < 16; ++i) {\n      w[i] = bytes.getInt32();\n    }\n    for(; i < 64; ++i) {\n      // XOR word 2 words ago rot right 17, rot right 19, shft right 10\n      t1 = w[i - 2];\n      t1 =\n        ((t1 >>> 17) | (t1 << 15)) ^\n        ((t1 >>> 19) | (t1 << 13)) ^\n        (t1 >>> 10);\n      // XOR word 15 words ago rot right 7, rot right 18, shft right 3\n      t2 = w[i - 15];\n      t2 =\n        ((t2 >>> 7) | (t2 << 25)) ^\n        ((t2 >>> 18) | (t2 << 14)) ^\n        (t2 >>> 3);\n      // sum(t1, word 7 ago, t2, word 16 ago) modulo 2^32\n      w[i] = (t1 + w[i - 7] + t2 + w[i - 16]) | 0;\n    }\n\n    // initialize hash value for this chunk\n    a = s.h0;\n    b = s.h1;\n    c = s.h2;\n    d = s.h3;\n    e = s.h4;\n    f = s.h5;\n    g = s.h6;\n    h = s.h7;\n\n    // round function\n    for(i = 0; i < 64; ++i) {\n      // Sum1(e)\n      s1 =\n        ((e >>> 6) | (e << 26)) ^\n        ((e >>> 11) | (e << 21)) ^\n        ((e >>> 25) | (e << 7));\n      // Ch(e, f, g) (optimized the same way as SHA-1)\n      ch = g ^ (e & (f ^ g));\n      // Sum0(a)\n      s0 =\n        ((a >>> 2) | (a << 30)) ^\n        ((a >>> 13) | (a << 19)) ^\n        ((a >>> 22) | (a << 10));\n      // Maj(a, b, c) (optimized the same way as SHA-1)\n      maj = (a & b) | (c & (a ^ b));\n\n      // main algorithm\n      t1 = h + s1 + ch + _k[i] + w[i];\n      t2 = s0 + maj;\n      h = g;\n      g = f;\n      f = e;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      // can't truncate with `| 0`\n      e = (d + t1) >>> 0;\n      d = c;\n      c = b;\n      b = a;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      // can't truncate with `| 0`\n      a = (t1 + t2) >>> 0;\n    }\n\n    // update hash state\n    s.h0 = (s.h0 + a) | 0;\n    s.h1 = (s.h1 + b) | 0;\n    s.h2 = (s.h2 + c) | 0;\n    s.h3 = (s.h3 + d) | 0;\n    s.h4 = (s.h4 + e) | 0;\n    s.h5 = (s.h5 + f) | 0;\n    s.h6 = (s.h6 + g) | 0;\n    s.h7 = (s.h7 + h) | 0;\n    len -= 64;\n  }\n}\n","/**\n * Javascript implementation of basic RSA algorithms.\n *\n * @author Dave Longley\n *\n * Copyright (c) 2010-2014 Digital Bazaar, Inc.\n *\n * The only algorithm currently supported for PKI is RSA.\n *\n * An RSA key is often stored in ASN.1 DER format. The SubjectPublicKeyInfo\n * ASN.1 structure is composed of an algorithm of type AlgorithmIdentifier\n * and a subjectPublicKey of type bit string.\n *\n * The AlgorithmIdentifier contains an Object Identifier (OID) and parameters\n * for the algorithm, if any. In the case of RSA, there aren't any.\n *\n * SubjectPublicKeyInfo ::= SEQUENCE {\n *   algorithm AlgorithmIdentifier,\n *   subjectPublicKey BIT STRING\n * }\n *\n * AlgorithmIdentifer ::= SEQUENCE {\n *   algorithm OBJECT IDENTIFIER,\n *   parameters ANY DEFINED BY algorithm OPTIONAL\n * }\n *\n * For an RSA public key, the subjectPublicKey is:\n *\n * RSAPublicKey ::= SEQUENCE {\n *   modulus            INTEGER,    -- n\n *   publicExponent     INTEGER     -- e\n * }\n *\n * PrivateKeyInfo ::= SEQUENCE {\n *   version                   Version,\n *   privateKeyAlgorithm       PrivateKeyAlgorithmIdentifier,\n *   privateKey                PrivateKey,\n *   attributes           [0]  IMPLICIT Attributes OPTIONAL\n * }\n *\n * Version ::= INTEGER\n * PrivateKeyAlgorithmIdentifier ::= AlgorithmIdentifier\n * PrivateKey ::= OCTET STRING\n * Attributes ::= SET OF Attribute\n *\n * An RSA private key as the following structure:\n *\n * RSAPrivateKey ::= SEQUENCE {\n *   version Version,\n *   modulus INTEGER, -- n\n *   publicExponent INTEGER, -- e\n *   privateExponent INTEGER, -- d\n *   prime1 INTEGER, -- p\n *   prime2 INTEGER, -- q\n *   exponent1 INTEGER, -- d mod (p-1)\n *   exponent2 INTEGER, -- d mod (q-1)\n *   coefficient INTEGER -- (inverse of q) mod p\n * }\n *\n * Version ::= INTEGER\n *\n * The OID for the RSA key algorithm is: 1.2.840.113549.1.1.1\n */\nvar forge = require('./forge');\nrequire('./asn1');\nrequire('./jsbn');\nrequire('./oids');\nrequire('./pkcs1');\nrequire('./prime');\nrequire('./random');\nrequire('./util');\n\nif(typeof BigInteger === 'undefined') {\n  var BigInteger = forge.jsbn.BigInteger;\n}\n\nvar _crypto = forge.util.isNodejs ? require('crypto') : null;\n\n// shortcut for asn.1 API\nvar asn1 = forge.asn1;\n\n// shortcut for util API\nvar util = forge.util;\n\n/*\n * RSA encryption and decryption, see RFC 2313.\n */\nforge.pki = forge.pki || {};\nmodule.exports = forge.pki.rsa = forge.rsa = forge.rsa || {};\nvar pki = forge.pki;\n\n// for finding primes, which are 30k+i for i = 1, 7, 11, 13, 17, 19, 23, 29\nvar GCD_30_DELTA = [6, 4, 2, 4, 2, 4, 6, 2];\n\n// validator for a PrivateKeyInfo structure\nvar privateKeyValidator = {\n  // PrivateKeyInfo\n  name: 'PrivateKeyInfo',\n  tagClass: asn1.Class.UNIVERSAL,\n  type: asn1.Type.SEQUENCE,\n  constructed: true,\n  value: [{\n    // Version (INTEGER)\n    name: 'PrivateKeyInfo.version',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.INTEGER,\n    constructed: false,\n    capture: 'privateKeyVersion'\n  }, {\n    // privateKeyAlgorithm\n    name: 'PrivateKeyInfo.privateKeyAlgorithm',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.SEQUENCE,\n    constructed: true,\n    value: [{\n      name: 'AlgorithmIdentifier.algorithm',\n      tagClass: asn1.Class.UNIVERSAL,\n      type: asn1.Type.OID,\n      constructed: false,\n      capture: 'privateKeyOid'\n    }]\n  }, {\n    // PrivateKey\n    name: 'PrivateKeyInfo',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.OCTETSTRING,\n    constructed: false,\n    capture: 'privateKey'\n  }]\n};\n\n// validator for an RSA private key\nvar rsaPrivateKeyValidator = {\n  // RSAPrivateKey\n  name: 'RSAPrivateKey',\n  tagClass: asn1.Class.UNIVERSAL,\n  type: asn1.Type.SEQUENCE,\n  constructed: true,\n  value: [{\n    // Version (INTEGER)\n    name: 'RSAPrivateKey.version',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.INTEGER,\n    constructed: false,\n    capture: 'privateKeyVersion'\n  }, {\n    // modulus (n)\n    name: 'RSAPrivateKey.modulus',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.INTEGER,\n    constructed: false,\n    capture: 'privateKeyModulus'\n  }, {\n    // publicExponent (e)\n    name: 'RSAPrivateKey.publicExponent',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.INTEGER,\n    constructed: false,\n    capture: 'privateKeyPublicExponent'\n  }, {\n    // privateExponent (d)\n    name: 'RSAPrivateKey.privateExponent',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.INTEGER,\n    constructed: false,\n    capture: 'privateKeyPrivateExponent'\n  }, {\n    // prime1 (p)\n    name: 'RSAPrivateKey.prime1',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.INTEGER,\n    constructed: false,\n    capture: 'privateKeyPrime1'\n  }, {\n    // prime2 (q)\n    name: 'RSAPrivateKey.prime2',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.INTEGER,\n    constructed: false,\n    capture: 'privateKeyPrime2'\n  }, {\n    // exponent1 (d mod (p-1))\n    name: 'RSAPrivateKey.exponent1',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.INTEGER,\n    constructed: false,\n    capture: 'privateKeyExponent1'\n  }, {\n    // exponent2 (d mod (q-1))\n    name: 'RSAPrivateKey.exponent2',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.INTEGER,\n    constructed: false,\n    capture: 'privateKeyExponent2'\n  }, {\n    // coefficient ((inverse of q) mod p)\n    name: 'RSAPrivateKey.coefficient',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.INTEGER,\n    constructed: false,\n    capture: 'privateKeyCoefficient'\n  }]\n};\n\n// validator for an RSA public key\nvar rsaPublicKeyValidator = {\n  // RSAPublicKey\n  name: 'RSAPublicKey',\n  tagClass: asn1.Class.UNIVERSAL,\n  type: asn1.Type.SEQUENCE,\n  constructed: true,\n  value: [{\n    // modulus (n)\n    name: 'RSAPublicKey.modulus',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.INTEGER,\n    constructed: false,\n    capture: 'publicKeyModulus'\n  }, {\n    // publicExponent (e)\n    name: 'RSAPublicKey.exponent',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.INTEGER,\n    constructed: false,\n    capture: 'publicKeyExponent'\n  }]\n};\n\n// validator for an SubjectPublicKeyInfo structure\n// Note: Currently only works with an RSA public key\nvar publicKeyValidator = forge.pki.rsa.publicKeyValidator = {\n  name: 'SubjectPublicKeyInfo',\n  tagClass: asn1.Class.UNIVERSAL,\n  type: asn1.Type.SEQUENCE,\n  constructed: true,\n  captureAsn1: 'subjectPublicKeyInfo',\n  value: [{\n    name: 'SubjectPublicKeyInfo.AlgorithmIdentifier',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.SEQUENCE,\n    constructed: true,\n    value: [{\n      name: 'AlgorithmIdentifier.algorithm',\n      tagClass: asn1.Class.UNIVERSAL,\n      type: asn1.Type.OID,\n      constructed: false,\n      capture: 'publicKeyOid'\n    }]\n  }, {\n    // subjectPublicKey\n    name: 'SubjectPublicKeyInfo.subjectPublicKey',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.BITSTRING,\n    constructed: false,\n    value: [{\n      // RSAPublicKey\n      name: 'SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey',\n      tagClass: asn1.Class.UNIVERSAL,\n      type: asn1.Type.SEQUENCE,\n      constructed: true,\n      optional: true,\n      captureAsn1: 'rsaPublicKey'\n    }]\n  }]\n};\n\n// validator for a DigestInfo structure\nvar digestInfoValidator = {\n  name: 'DigestInfo',\n  tagClass: asn1.Class.UNIVERSAL,\n  type: asn1.Type.SEQUENCE,\n  constructed: true,\n  value: [{\n    name: 'DigestInfo.DigestAlgorithm',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.SEQUENCE,\n    constructed: true,\n    value: [{\n      name: 'DigestInfo.DigestAlgorithm.algorithmIdentifier',\n      tagClass: asn1.Class.UNIVERSAL,\n      type: asn1.Type.OID,\n      constructed: false,\n      capture: 'algorithmIdentifier'\n    }, {\n      // NULL paramters\n      name: 'DigestInfo.DigestAlgorithm.parameters',\n      tagClass: asn1.Class.UNIVERSAL,\n      type: asn1.Type.NULL,\n      // captured only to check existence for md2 and md5\n      capture: 'parameters',\n      optional: true,\n      constructed: false\n    }]\n  }, {\n    // digest\n    name: 'DigestInfo.digest',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.OCTETSTRING,\n    constructed: false,\n    capture: 'digest'\n  }]\n};\n\n/**\n * Wrap digest in DigestInfo object.\n *\n * This function implements EMSA-PKCS1-v1_5-ENCODE as per RFC 3447.\n *\n * DigestInfo ::= SEQUENCE {\n *   digestAlgorithm DigestAlgorithmIdentifier,\n *   digest Digest\n * }\n *\n * DigestAlgorithmIdentifier ::= AlgorithmIdentifier\n * Digest ::= OCTET STRING\n *\n * @param md the message digest object with the hash to sign.\n *\n * @return the encoded message (ready for RSA encrytion)\n */\nvar emsaPkcs1v15encode = function(md) {\n  // get the oid for the algorithm\n  var oid;\n  if(md.algorithm in pki.oids) {\n    oid = pki.oids[md.algorithm];\n  } else {\n    var error = new Error('Unknown message digest algorithm.');\n    error.algorithm = md.algorithm;\n    throw error;\n  }\n  var oidBytes = asn1.oidToDer(oid).getBytes();\n\n  // create the digest info\n  var digestInfo = asn1.create(\n    asn1.Class.UNIVERSAL, asn1.Type.SEQUENCE, true, []);\n  var digestAlgorithm = asn1.create(\n    asn1.Class.UNIVERSAL, asn1.Type.SEQUENCE, true, []);\n  digestAlgorithm.value.push(asn1.create(\n    asn1.Class.UNIVERSAL, asn1.Type.OID, false, oidBytes));\n  digestAlgorithm.value.push(asn1.create(\n    asn1.Class.UNIVERSAL, asn1.Type.NULL, false, ''));\n  var digest = asn1.create(\n    asn1.Class.UNIVERSAL, asn1.Type.OCTETSTRING,\n    false, md.digest().getBytes());\n  digestInfo.value.push(digestAlgorithm);\n  digestInfo.value.push(digest);\n\n  // encode digest info\n  return asn1.toDer(digestInfo).getBytes();\n};\n\n/**\n * Performs x^c mod n (RSA encryption or decryption operation).\n *\n * @param x the number to raise and mod.\n * @param key the key to use.\n * @param pub true if the key is public, false if private.\n *\n * @return the result of x^c mod n.\n */\nvar _modPow = function(x, key, pub) {\n  if(pub) {\n    return x.modPow(key.e, key.n);\n  }\n\n  if(!key.p || !key.q) {\n    // allow calculation without CRT params (slow)\n    return x.modPow(key.d, key.n);\n  }\n\n  // pre-compute dP, dQ, and qInv if necessary\n  if(!key.dP) {\n    key.dP = key.d.mod(key.p.subtract(BigInteger.ONE));\n  }\n  if(!key.dQ) {\n    key.dQ = key.d.mod(key.q.subtract(BigInteger.ONE));\n  }\n  if(!key.qInv) {\n    key.qInv = key.q.modInverse(key.p);\n  }\n\n  /* Chinese remainder theorem (CRT) states:\n\n    Suppose n1, n2, ..., nk are positive integers which are pairwise\n    coprime (n1 and n2 have no common factors other than 1). For any\n    integers x1, x2, ..., xk there exists an integer x solving the\n    system of simultaneous congruences (where ~= means modularly\n    congruent so a ~= b mod n means a mod n = b mod n):\n\n    x ~= x1 mod n1\n    x ~= x2 mod n2\n    ...\n    x ~= xk mod nk\n\n    This system of congruences has a single simultaneous solution x\n    between 0 and n - 1. Furthermore, each xk solution and x itself\n    is congruent modulo the product n = n1*n2*...*nk.\n    So x1 mod n = x2 mod n = xk mod n = x mod n.\n\n    The single simultaneous solution x can be solved with the following\n    equation:\n\n    x = sum(xi*ri*si) mod n where ri = n/ni and si = ri^-1 mod ni.\n\n    Where x is less than n, xi = x mod ni.\n\n    For RSA we are only concerned with k = 2. The modulus n = pq, where\n    p and q are coprime. The RSA decryption algorithm is:\n\n    y = x^d mod n\n\n    Given the above:\n\n    x1 = x^d mod p\n    r1 = n/p = q\n    s1 = q^-1 mod p\n    x2 = x^d mod q\n    r2 = n/q = p\n    s2 = p^-1 mod q\n\n    So y = (x1r1s1 + x2r2s2) mod n\n         = ((x^d mod p)q(q^-1 mod p) + (x^d mod q)p(p^-1 mod q)) mod n\n\n    According to Fermat's Little Theorem, if the modulus P is prime,\n    for any integer A not evenly divisible by P, A^(P-1) ~= 1 mod P.\n    Since A is not divisible by P it follows that if:\n    N ~= M mod (P - 1), then A^N mod P = A^M mod P. Therefore:\n\n    A^N mod P = A^(M mod (P - 1)) mod P. (The latter takes less effort\n    to calculate). In order to calculate x^d mod p more quickly the\n    exponent d mod (p - 1) is stored in the RSA private key (the same\n    is done for x^d mod q). These values are referred to as dP and dQ\n    respectively. Therefore we now have:\n\n    y = ((x^dP mod p)q(q^-1 mod p) + (x^dQ mod q)p(p^-1 mod q)) mod n\n\n    Since we'll be reducing x^dP by modulo p (same for q) we can also\n    reduce x by p (and q respectively) before hand. Therefore, let\n\n    xp = ((x mod p)^dP mod p), and\n    xq = ((x mod q)^dQ mod q), yielding:\n\n    y = (xp*q*(q^-1 mod p) + xq*p*(p^-1 mod q)) mod n\n\n    This can be further reduced to a simple algorithm that only\n    requires 1 inverse (the q inverse is used) to be used and stored.\n    The algorithm is called Garner's algorithm. If qInv is the\n    inverse of q, we simply calculate:\n\n    y = (qInv*(xp - xq) mod p) * q + xq\n\n    However, there are two further complications. First, we need to\n    ensure that xp > xq to prevent signed BigIntegers from being used\n    so we add p until this is true (since we will be mod'ing with\n    p anyway). Then, there is a known timing attack on algorithms\n    using the CRT. To mitigate this risk, \"cryptographic blinding\"\n    should be used. This requires simply generating a random number r\n    between 0 and n-1 and its inverse and multiplying x by r^e before\n    calculating y and then multiplying y by r^-1 afterwards. Note that\n    r must be coprime with n (gcd(r, n) === 1) in order to have an\n    inverse.\n  */\n\n  // cryptographic blinding\n  var r;\n  do {\n    r = new BigInteger(\n      forge.util.bytesToHex(forge.random.getBytes(key.n.bitLength() / 8)),\n      16);\n  } while(r.compareTo(key.n) >= 0 || !r.gcd(key.n).equals(BigInteger.ONE));\n  x = x.multiply(r.modPow(key.e, key.n)).mod(key.n);\n\n  // calculate xp and xq\n  var xp = x.mod(key.p).modPow(key.dP, key.p);\n  var xq = x.mod(key.q).modPow(key.dQ, key.q);\n\n  // xp must be larger than xq to avoid signed bit usage\n  while(xp.compareTo(xq) < 0) {\n    xp = xp.add(key.p);\n  }\n\n  // do last step\n  var y = xp.subtract(xq)\n    .multiply(key.qInv).mod(key.p)\n    .multiply(key.q).add(xq);\n\n  // remove effect of random for cryptographic blinding\n  y = y.multiply(r.modInverse(key.n)).mod(key.n);\n\n  return y;\n};\n\n/**\n * NOTE: THIS METHOD IS DEPRECATED, use 'sign' on a private key object or\n * 'encrypt' on a public key object instead.\n *\n * Performs RSA encryption.\n *\n * The parameter bt controls whether to put padding bytes before the\n * message passed in. Set bt to either true or false to disable padding\n * completely (in order to handle e.g. EMSA-PSS encoding seperately before),\n * signaling whether the encryption operation is a public key operation\n * (i.e. encrypting data) or not, i.e. private key operation (data signing).\n *\n * For PKCS#1 v1.5 padding pass in the block type to use, i.e. either 0x01\n * (for signing) or 0x02 (for encryption). The key operation mode (private\n * or public) is derived from this flag in that case).\n *\n * @param m the message to encrypt as a byte string.\n * @param key the RSA key to use.\n * @param bt for PKCS#1 v1.5 padding, the block type to use\n *   (0x01 for private key, 0x02 for public),\n *   to disable padding: true = public key, false = private key.\n *\n * @return the encrypted bytes as a string.\n */\npki.rsa.encrypt = function(m, key, bt) {\n  var pub = bt;\n  var eb;\n\n  // get the length of the modulus in bytes\n  var k = Math.ceil(key.n.bitLength() / 8);\n\n  if(bt !== false && bt !== true) {\n    // legacy, default to PKCS#1 v1.5 padding\n    pub = (bt === 0x02);\n    eb = _encodePkcs1_v1_5(m, key, bt);\n  } else {\n    eb = forge.util.createBuffer();\n    eb.putBytes(m);\n  }\n\n  // load encryption block as big integer 'x'\n  // FIXME: hex conversion inefficient, get BigInteger w/byte strings\n  var x = new BigInteger(eb.toHex(), 16);\n\n  // do RSA encryption\n  var y = _modPow(x, key, pub);\n\n  // convert y into the encrypted data byte string, if y is shorter in\n  // bytes than k, then prepend zero bytes to fill up ed\n  // FIXME: hex conversion inefficient, get BigInteger w/byte strings\n  var yhex = y.toString(16);\n  var ed = forge.util.createBuffer();\n  var zeros = k - Math.ceil(yhex.length / 2);\n  while(zeros > 0) {\n    ed.putByte(0x00);\n    --zeros;\n  }\n  ed.putBytes(forge.util.hexToBytes(yhex));\n  return ed.getBytes();\n};\n\n/**\n * NOTE: THIS METHOD IS DEPRECATED, use 'decrypt' on a private key object or\n * 'verify' on a public key object instead.\n *\n * Performs RSA decryption.\n *\n * The parameter ml controls whether to apply PKCS#1 v1.5 padding\n * or not.  Set ml = false to disable padding removal completely\n * (in order to handle e.g. EMSA-PSS later on) and simply pass back\n * the RSA encryption block.\n *\n * @param ed the encrypted data to decrypt in as a byte string.\n * @param key the RSA key to use.\n * @param pub true for a public key operation, false for private.\n * @param ml the message length, if known, false to disable padding.\n *\n * @return the decrypted message as a byte string.\n */\npki.rsa.decrypt = function(ed, key, pub, ml) {\n  // get the length of the modulus in bytes\n  var k = Math.ceil(key.n.bitLength() / 8);\n\n  // error if the length of the encrypted data ED is not k\n  if(ed.length !== k) {\n    var error = new Error('Encrypted message length is invalid.');\n    error.length = ed.length;\n    error.expected = k;\n    throw error;\n  }\n\n  // convert encrypted data into a big integer\n  // FIXME: hex conversion inefficient, get BigInteger w/byte strings\n  var y = new BigInteger(forge.util.createBuffer(ed).toHex(), 16);\n\n  // y must be less than the modulus or it wasn't the result of\n  // a previous mod operation (encryption) using that modulus\n  if(y.compareTo(key.n) >= 0) {\n    throw new Error('Encrypted message is invalid.');\n  }\n\n  // do RSA decryption\n  var x = _modPow(y, key, pub);\n\n  // create the encryption block, if x is shorter in bytes than k, then\n  // prepend zero bytes to fill up eb\n  // FIXME: hex conversion inefficient, get BigInteger w/byte strings\n  var xhex = x.toString(16);\n  var eb = forge.util.createBuffer();\n  var zeros = k - Math.ceil(xhex.length / 2);\n  while(zeros > 0) {\n    eb.putByte(0x00);\n    --zeros;\n  }\n  eb.putBytes(forge.util.hexToBytes(xhex));\n\n  if(ml !== false) {\n    // legacy, default to PKCS#1 v1.5 padding\n    return _decodePkcs1_v1_5(eb.getBytes(), key, pub);\n  }\n\n  // return message\n  return eb.getBytes();\n};\n\n/**\n * Creates an RSA key-pair generation state object. It is used to allow\n * key-generation to be performed in steps. It also allows for a UI to\n * display progress updates.\n *\n * @param bits the size for the private key in bits, defaults to 2048.\n * @param e the public exponent to use, defaults to 65537 (0x10001).\n * @param [options] the options to use.\n *          prng a custom crypto-secure pseudo-random number generator to use,\n *            that must define \"getBytesSync\".\n *          algorithm the algorithm to use (default: 'PRIMEINC').\n *\n * @return the state object to use to generate the key-pair.\n */\npki.rsa.createKeyPairGenerationState = function(bits, e, options) {\n  // TODO: migrate step-based prime generation code to forge.prime\n\n  // set default bits\n  if(typeof(bits) === 'string') {\n    bits = parseInt(bits, 10);\n  }\n  bits = bits || 2048;\n\n  // create prng with api that matches BigInteger secure random\n  options = options || {};\n  var prng = options.prng || forge.random;\n  var rng = {\n    // x is an array to fill with bytes\n    nextBytes: function(x) {\n      var b = prng.getBytesSync(x.length);\n      for(var i = 0; i < x.length; ++i) {\n        x[i] = b.charCodeAt(i);\n      }\n    }\n  };\n\n  var algorithm = options.algorithm || 'PRIMEINC';\n\n  // create PRIMEINC algorithm state\n  var rval;\n  if(algorithm === 'PRIMEINC') {\n    rval = {\n      algorithm: algorithm,\n      state: 0,\n      bits: bits,\n      rng: rng,\n      eInt: e || 65537,\n      e: new BigInteger(null),\n      p: null,\n      q: null,\n      qBits: bits >> 1,\n      pBits: bits - (bits >> 1),\n      pqState: 0,\n      num: null,\n      keys: null\n    };\n    rval.e.fromInt(rval.eInt);\n  } else {\n    throw new Error('Invalid key generation algorithm: ' + algorithm);\n  }\n\n  return rval;\n};\n\n/**\n * Attempts to runs the key-generation algorithm for at most n seconds\n * (approximately) using the given state. When key-generation has completed,\n * the keys will be stored in state.keys.\n *\n * To use this function to update a UI while generating a key or to prevent\n * causing browser lockups/warnings, set \"n\" to a value other than 0. A\n * simple pattern for generating a key and showing a progress indicator is:\n *\n * var state = pki.rsa.createKeyPairGenerationState(2048);\n * var step = function() {\n *   // step key-generation, run algorithm for 100 ms, repeat\n *   if(!forge.pki.rsa.stepKeyPairGenerationState(state, 100)) {\n *     setTimeout(step, 1);\n *   } else {\n *     // key-generation complete\n *     // TODO: turn off progress indicator here\n *     // TODO: use the generated key-pair in \"state.keys\"\n *   }\n * };\n * // TODO: turn on progress indicator here\n * setTimeout(step, 0);\n *\n * @param state the state to use.\n * @param n the maximum number of milliseconds to run the algorithm for, 0\n *          to run the algorithm to completion.\n *\n * @return true if the key-generation completed, false if not.\n */\npki.rsa.stepKeyPairGenerationState = function(state, n) {\n  // set default algorithm if not set\n  if(!('algorithm' in state)) {\n    state.algorithm = 'PRIMEINC';\n  }\n\n  // TODO: migrate step-based prime generation code to forge.prime\n  // TODO: abstract as PRIMEINC algorithm\n\n  // do key generation (based on Tom Wu's rsa.js, see jsbn.js license)\n  // with some minor optimizations and designed to run in steps\n\n  // local state vars\n  var THIRTY = new BigInteger(null);\n  THIRTY.fromInt(30);\n  var deltaIdx = 0;\n  var op_or = function(x, y) {return x | y;};\n\n  // keep stepping until time limit is reached or done\n  var t1 = +new Date();\n  var t2;\n  var total = 0;\n  while(state.keys === null && (n <= 0 || total < n)) {\n    // generate p or q\n    if(state.state === 0) {\n      /* Note: All primes are of the form:\n\n        30k+i, for i < 30 and gcd(30, i)=1, where there are 8 values for i\n\n        When we generate a random number, we always align it at 30k + 1. Each\n        time the number is determined not to be prime we add to get to the\n        next 'i', eg: if the number was at 30k + 1 we add 6. */\n      var bits = (state.p === null) ? state.pBits : state.qBits;\n      var bits1 = bits - 1;\n\n      // get a random number\n      if(state.pqState === 0) {\n        state.num = new BigInteger(bits, state.rng);\n        // force MSB set\n        if(!state.num.testBit(bits1)) {\n          state.num.bitwiseTo(\n            BigInteger.ONE.shiftLeft(bits1), op_or, state.num);\n        }\n        // align number on 30k+1 boundary\n        state.num.dAddOffset(31 - state.num.mod(THIRTY).byteValue(), 0);\n        deltaIdx = 0;\n\n        ++state.pqState;\n      } else if(state.pqState === 1) {\n        // try to make the number a prime\n        if(state.num.bitLength() > bits) {\n          // overflow, try again\n          state.pqState = 0;\n          // do primality test\n        } else if(state.num.isProbablePrime(\n          _getMillerRabinTests(state.num.bitLength()))) {\n          ++state.pqState;\n        } else {\n          // get next potential prime\n          state.num.dAddOffset(GCD_30_DELTA[deltaIdx++ % 8], 0);\n        }\n      } else if(state.pqState === 2) {\n        // ensure number is coprime with e\n        state.pqState =\n          (state.num.subtract(BigInteger.ONE).gcd(state.e)\n            .compareTo(BigInteger.ONE) === 0) ? 3 : 0;\n      } else if(state.pqState === 3) {\n        // store p or q\n        state.pqState = 0;\n        if(state.p === null) {\n          state.p = state.num;\n        } else {\n          state.q = state.num;\n        }\n\n        // advance state if both p and q are ready\n        if(state.p !== null && state.q !== null) {\n          ++state.state;\n        }\n        state.num = null;\n      }\n    } else if(state.state === 1) {\n      // ensure p is larger than q (swap them if not)\n      if(state.p.compareTo(state.q) < 0) {\n        state.num = state.p;\n        state.p = state.q;\n        state.q = state.num;\n      }\n      ++state.state;\n    } else if(state.state === 2) {\n      // compute phi: (p - 1)(q - 1) (Euler's totient function)\n      state.p1 = state.p.subtract(BigInteger.ONE);\n      state.q1 = state.q.subtract(BigInteger.ONE);\n      state.phi = state.p1.multiply(state.q1);\n      ++state.state;\n    } else if(state.state === 3) {\n      // ensure e and phi are coprime\n      if(state.phi.gcd(state.e).compareTo(BigInteger.ONE) === 0) {\n        // phi and e are coprime, advance\n        ++state.state;\n      } else {\n        // phi and e aren't coprime, so generate a new p and q\n        state.p = null;\n        state.q = null;\n        state.state = 0;\n      }\n    } else if(state.state === 4) {\n      // create n, ensure n is has the right number of bits\n      state.n = state.p.multiply(state.q);\n\n      // ensure n is right number of bits\n      if(state.n.bitLength() === state.bits) {\n        // success, advance\n        ++state.state;\n      } else {\n        // failed, get new q\n        state.q = null;\n        state.state = 0;\n      }\n    } else if(state.state === 5) {\n      // set keys\n      var d = state.e.modInverse(state.phi);\n      state.keys = {\n        privateKey: pki.rsa.setPrivateKey(\n          state.n, state.e, d, state.p, state.q,\n          d.mod(state.p1), d.mod(state.q1),\n          state.q.modInverse(state.p)),\n        publicKey: pki.rsa.setPublicKey(state.n, state.e)\n      };\n    }\n\n    // update timing\n    t2 = +new Date();\n    total += t2 - t1;\n    t1 = t2;\n  }\n\n  return state.keys !== null;\n};\n\n/**\n * Generates an RSA public-private key pair in a single call.\n *\n * To generate a key-pair in steps (to allow for progress updates and to\n * prevent blocking or warnings in slow browsers) then use the key-pair\n * generation state functions.\n *\n * To generate a key-pair asynchronously (either through web-workers, if\n * available, or by breaking up the work on the main thread), pass a\n * callback function.\n *\n * @param [bits] the size for the private key in bits, defaults to 2048.\n * @param [e] the public exponent to use, defaults to 65537.\n * @param [options] options for key-pair generation, if given then 'bits'\n *            and 'e' must *not* be given:\n *          bits the size for the private key in bits, (default: 2048).\n *          e the public exponent to use, (default: 65537 (0x10001)).\n *          workerScript the worker script URL.\n *          workers the number of web workers (if supported) to use,\n *            (default: 2).\n *          workLoad the size of the work load, ie: number of possible prime\n *            numbers for each web worker to check per work assignment,\n *            (default: 100).\n *          prng a custom crypto-secure pseudo-random number generator to use,\n *            that must define \"getBytesSync\". Disables use of native APIs.\n *          algorithm the algorithm to use (default: 'PRIMEINC').\n * @param [callback(err, keypair)] called once the operation completes.\n *\n * @return an object with privateKey and publicKey properties.\n */\npki.rsa.generateKeyPair = function(bits, e, options, callback) {\n  // (bits), (options), (callback)\n  if(arguments.length === 1) {\n    if(typeof bits === 'object') {\n      options = bits;\n      bits = undefined;\n    } else if(typeof bits === 'function') {\n      callback = bits;\n      bits = undefined;\n    }\n  } else if(arguments.length === 2) {\n    // (bits, e), (bits, options), (bits, callback), (options, callback)\n    if(typeof bits === 'number') {\n      if(typeof e === 'function') {\n        callback = e;\n        e = undefined;\n      } else if(typeof e !== 'number') {\n        options = e;\n        e = undefined;\n      }\n    } else {\n      options = bits;\n      callback = e;\n      bits = undefined;\n      e = undefined;\n    }\n  } else if(arguments.length === 3) {\n    // (bits, e, options), (bits, e, callback), (bits, options, callback)\n    if(typeof e === 'number') {\n      if(typeof options === 'function') {\n        callback = options;\n        options = undefined;\n      }\n    } else {\n      callback = options;\n      options = e;\n      e = undefined;\n    }\n  }\n  options = options || {};\n  if(bits === undefined) {\n    bits = options.bits || 2048;\n  }\n  if(e === undefined) {\n    e = options.e || 0x10001;\n  }\n\n  // use native code if permitted, available, and parameters are acceptable\n  if(!forge.options.usePureJavaScript && !options.prng &&\n    bits >= 256 && bits <= 16384 && (e === 0x10001 || e === 3)) {\n    if(callback) {\n      // try native async\n      if(_detectNodeCrypto('generateKeyPair')) {\n        return _crypto.generateKeyPair('rsa', {\n          modulusLength: bits,\n          publicExponent: e,\n          publicKeyEncoding: {\n            type: 'spki',\n            format: 'pem'\n          },\n          privateKeyEncoding: {\n            type: 'pkcs8',\n            format: 'pem'\n          }\n        }, function(err, pub, priv) {\n          if(err) {\n            return callback(err);\n          }\n          callback(null, {\n            privateKey: pki.privateKeyFromPem(priv),\n            publicKey: pki.publicKeyFromPem(pub)\n          });\n        });\n      }\n      if(_detectSubtleCrypto('generateKey') &&\n        _detectSubtleCrypto('exportKey')) {\n        // use standard native generateKey\n        return util.globalScope.crypto.subtle.generateKey({\n          name: 'RSASSA-PKCS1-v1_5',\n          modulusLength: bits,\n          publicExponent: _intToUint8Array(e),\n          hash: {name: 'SHA-256'}\n        }, true /* key can be exported*/, ['sign', 'verify'])\n        .then(function(pair) {\n          return util.globalScope.crypto.subtle.exportKey(\n            'pkcs8', pair.privateKey);\n        // avoiding catch(function(err) {...}) to support IE <= 8\n        }).then(undefined, function(err) {\n          callback(err);\n        }).then(function(pkcs8) {\n          if(pkcs8) {\n            var privateKey = pki.privateKeyFromAsn1(\n              asn1.fromDer(forge.util.createBuffer(pkcs8)));\n            callback(null, {\n              privateKey: privateKey,\n              publicKey: pki.setRsaPublicKey(privateKey.n, privateKey.e)\n            });\n          }\n        });\n      }\n      if(_detectSubtleMsCrypto('generateKey') &&\n        _detectSubtleMsCrypto('exportKey')) {\n        var genOp = util.globalScope.msCrypto.subtle.generateKey({\n          name: 'RSASSA-PKCS1-v1_5',\n          modulusLength: bits,\n          publicExponent: _intToUint8Array(e),\n          hash: {name: 'SHA-256'}\n        }, true /* key can be exported*/, ['sign', 'verify']);\n        genOp.oncomplete = function(e) {\n          var pair = e.target.result;\n          var exportOp = util.globalScope.msCrypto.subtle.exportKey(\n            'pkcs8', pair.privateKey);\n          exportOp.oncomplete = function(e) {\n            var pkcs8 = e.target.result;\n            var privateKey = pki.privateKeyFromAsn1(\n              asn1.fromDer(forge.util.createBuffer(pkcs8)));\n            callback(null, {\n              privateKey: privateKey,\n              publicKey: pki.setRsaPublicKey(privateKey.n, privateKey.e)\n            });\n          };\n          exportOp.onerror = function(err) {\n            callback(err);\n          };\n        };\n        genOp.onerror = function(err) {\n          callback(err);\n        };\n        return;\n      }\n    } else {\n      // try native sync\n      if(_detectNodeCrypto('generateKeyPairSync')) {\n        var keypair = _crypto.generateKeyPairSync('rsa', {\n          modulusLength: bits,\n          publicExponent: e,\n          publicKeyEncoding: {\n            type: 'spki',\n            format: 'pem'\n          },\n          privateKeyEncoding: {\n            type: 'pkcs8',\n            format: 'pem'\n          }\n        });\n        return {\n          privateKey: pki.privateKeyFromPem(keypair.privateKey),\n          publicKey: pki.publicKeyFromPem(keypair.publicKey)\n        };\n      }\n    }\n  }\n\n  // use JavaScript implementation\n  var state = pki.rsa.createKeyPairGenerationState(bits, e, options);\n  if(!callback) {\n    pki.rsa.stepKeyPairGenerationState(state, 0);\n    return state.keys;\n  }\n  _generateKeyPair(state, options, callback);\n};\n\n/**\n * Sets an RSA public key from BigIntegers modulus and exponent.\n *\n * @param n the modulus.\n * @param e the exponent.\n *\n * @return the public key.\n */\npki.setRsaPublicKey = pki.rsa.setPublicKey = function(n, e) {\n  var key = {\n    n: n,\n    e: e\n  };\n\n  /**\n   * Encrypts the given data with this public key. Newer applications\n   * should use the 'RSA-OAEP' decryption scheme, 'RSAES-PKCS1-V1_5' is for\n   * legacy applications.\n   *\n   * @param data the byte string to encrypt.\n   * @param scheme the encryption scheme to use:\n   *          'RSAES-PKCS1-V1_5' (default),\n   *          'RSA-OAEP',\n   *          'RAW', 'NONE', or null to perform raw RSA encryption,\n   *          an object with an 'encode' property set to a function\n   *          with the signature 'function(data, key)' that returns\n   *          a binary-encoded string representing the encoded data.\n   * @param schemeOptions any scheme-specific options.\n   *\n   * @return the encrypted byte string.\n   */\n  key.encrypt = function(data, scheme, schemeOptions) {\n    if(typeof scheme === 'string') {\n      scheme = scheme.toUpperCase();\n    } else if(scheme === undefined) {\n      scheme = 'RSAES-PKCS1-V1_5';\n    }\n\n    if(scheme === 'RSAES-PKCS1-V1_5') {\n      scheme = {\n        encode: function(m, key, pub) {\n          return _encodePkcs1_v1_5(m, key, 0x02).getBytes();\n        }\n      };\n    } else if(scheme === 'RSA-OAEP' || scheme === 'RSAES-OAEP') {\n      scheme = {\n        encode: function(m, key) {\n          return forge.pkcs1.encode_rsa_oaep(key, m, schemeOptions);\n        }\n      };\n    } else if(['RAW', 'NONE', 'NULL', null].indexOf(scheme) !== -1) {\n      scheme = {encode: function(e) {return e;}};\n    } else if(typeof scheme === 'string') {\n      throw new Error('Unsupported encryption scheme: \"' + scheme + '\".');\n    }\n\n    // do scheme-based encoding then rsa encryption\n    var e = scheme.encode(data, key, true);\n    return pki.rsa.encrypt(e, key, true);\n  };\n\n  /**\n   * Verifies the given signature against the given digest.\n   *\n   * PKCS#1 supports multiple (currently two) signature schemes:\n   * RSASSA-PKCS1-V1_5 and RSASSA-PSS.\n   *\n   * By default this implementation uses the \"old scheme\", i.e.\n   * RSASSA-PKCS1-V1_5, in which case once RSA-decrypted, the\n   * signature is an OCTET STRING that holds a DigestInfo.\n   *\n   * DigestInfo ::= SEQUENCE {\n   *   digestAlgorithm DigestAlgorithmIdentifier,\n   *   digest Digest\n   * }\n   * DigestAlgorithmIdentifier ::= AlgorithmIdentifier\n   * Digest ::= OCTET STRING\n   *\n   * To perform PSS signature verification, provide an instance\n   * of Forge PSS object as the scheme parameter.\n   *\n   * @param digest the message digest hash to compare against the signature,\n   *          as a binary-encoded string.\n   * @param signature the signature to verify, as a binary-encoded string.\n   * @param scheme signature verification scheme to use:\n   *          'RSASSA-PKCS1-V1_5' or undefined for RSASSA PKCS#1 v1.5,\n   *          a Forge PSS object for RSASSA-PSS,\n   *          'NONE' or null for none, DigestInfo will not be expected, but\n   *            PKCS#1 v1.5 padding will still be used.\n   * @param options optional verify options\n   *          _parseAllDigestBytes testing flag to control parsing of all\n   *            digest bytes. Unsupported and not for general usage.\n   *            (default: true)\n   *\n   * @return true if the signature was verified, false if not.\n   */\n  key.verify = function(digest, signature, scheme, options) {\n    if(typeof scheme === 'string') {\n      scheme = scheme.toUpperCase();\n    } else if(scheme === undefined) {\n      scheme = 'RSASSA-PKCS1-V1_5';\n    }\n    if(options === undefined) {\n      options = {\n        _parseAllDigestBytes: true\n      };\n    }\n    if(!('_parseAllDigestBytes' in options)) {\n      options._parseAllDigestBytes = true;\n    }\n\n    if(scheme === 'RSASSA-PKCS1-V1_5') {\n      scheme = {\n        verify: function(digest, d) {\n          // remove padding\n          d = _decodePkcs1_v1_5(d, key, true);\n          // d is ASN.1 BER-encoded DigestInfo\n          var obj = asn1.fromDer(d, {\n            parseAllBytes: options._parseAllDigestBytes\n          });\n\n          // validate DigestInfo\n          var capture = {};\n          var errors = [];\n          if(!asn1.validate(obj, digestInfoValidator, capture, errors)) {\n            var error = new Error(\n              'ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 ' +\n              'DigestInfo value.');\n            error.errors = errors;\n            throw error;\n          }\n          // check hash algorithm identifier\n          // see PKCS1-v1-5DigestAlgorithms in RFC 8017\n          // FIXME: add support to vaidator for strict value choices\n          var oid = asn1.derToOid(capture.algorithmIdentifier);\n          if(!(oid === forge.oids.md2 ||\n            oid === forge.oids.md5 ||\n            oid === forge.oids.sha1 ||\n            oid === forge.oids.sha224 ||\n            oid === forge.oids.sha256 ||\n            oid === forge.oids.sha384 ||\n            oid === forge.oids.sha512 ||\n            oid === forge.oids['sha512-224'] ||\n            oid === forge.oids['sha512-256'])) {\n            var error = new Error(\n              'Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.');\n            error.oid = oid;\n            throw error;\n          }\n\n          // special check for md2 and md5 that NULL parameters exist\n          if(oid === forge.oids.md2 || oid === forge.oids.md5) {\n            if(!('parameters' in capture)) {\n              throw new Error(\n                'ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 ' +\n                'DigestInfo value. ' +\n                'Missing algorithm identifer NULL parameters.');\n            }\n          }\n\n          // compare the given digest to the decrypted one\n          return digest === capture.digest;\n        }\n      };\n    } else if(scheme === 'NONE' || scheme === 'NULL' || scheme === null) {\n      scheme = {\n        verify: function(digest, d) {\n          // remove padding\n          d = _decodePkcs1_v1_5(d, key, true);\n          return digest === d;\n        }\n      };\n    }\n\n    // do rsa decryption w/o any decoding, then verify -- which does decoding\n    var d = pki.rsa.decrypt(signature, key, true, false);\n    return scheme.verify(digest, d, key.n.bitLength());\n  };\n\n  return key;\n};\n\n/**\n * Sets an RSA private key from BigIntegers modulus, exponent, primes,\n * prime exponents, and modular multiplicative inverse.\n *\n * @param n the modulus.\n * @param e the public exponent.\n * @param d the private exponent ((inverse of e) mod n).\n * @param p the first prime.\n * @param q the second prime.\n * @param dP exponent1 (d mod (p-1)).\n * @param dQ exponent2 (d mod (q-1)).\n * @param qInv ((inverse of q) mod p)\n *\n * @return the private key.\n */\npki.setRsaPrivateKey = pki.rsa.setPrivateKey = function(\n  n, e, d, p, q, dP, dQ, qInv) {\n  var key = {\n    n: n,\n    e: e,\n    d: d,\n    p: p,\n    q: q,\n    dP: dP,\n    dQ: dQ,\n    qInv: qInv\n  };\n\n  /**\n   * Decrypts the given data with this private key. The decryption scheme\n   * must match the one used to encrypt the data.\n   *\n   * @param data the byte string to decrypt.\n   * @param scheme the decryption scheme to use:\n   *          'RSAES-PKCS1-V1_5' (default),\n   *          'RSA-OAEP',\n   *          'RAW', 'NONE', or null to perform raw RSA decryption.\n   * @param schemeOptions any scheme-specific options.\n   *\n   * @return the decrypted byte string.\n   */\n  key.decrypt = function(data, scheme, schemeOptions) {\n    if(typeof scheme === 'string') {\n      scheme = scheme.toUpperCase();\n    } else if(scheme === undefined) {\n      scheme = 'RSAES-PKCS1-V1_5';\n    }\n\n    // do rsa decryption w/o any decoding\n    var d = pki.rsa.decrypt(data, key, false, false);\n\n    if(scheme === 'RSAES-PKCS1-V1_5') {\n      scheme = {decode: _decodePkcs1_v1_5};\n    } else if(scheme === 'RSA-OAEP' || scheme === 'RSAES-OAEP') {\n      scheme = {\n        decode: function(d, key) {\n          return forge.pkcs1.decode_rsa_oaep(key, d, schemeOptions);\n        }\n      };\n    } else if(['RAW', 'NONE', 'NULL', null].indexOf(scheme) !== -1) {\n      scheme = {decode: function(d) {return d;}};\n    } else {\n      throw new Error('Unsupported encryption scheme: \"' + scheme + '\".');\n    }\n\n    // decode according to scheme\n    return scheme.decode(d, key, false);\n  };\n\n  /**\n   * Signs the given digest, producing a signature.\n   *\n   * PKCS#1 supports multiple (currently two) signature schemes:\n   * RSASSA-PKCS1-V1_5 and RSASSA-PSS.\n   *\n   * By default this implementation uses the \"old scheme\", i.e.\n   * RSASSA-PKCS1-V1_5. In order to generate a PSS signature, provide\n   * an instance of Forge PSS object as the scheme parameter.\n   *\n   * @param md the message digest object with the hash to sign.\n   * @param scheme the signature scheme to use:\n   *          'RSASSA-PKCS1-V1_5' or undefined for RSASSA PKCS#1 v1.5,\n   *          a Forge PSS object for RSASSA-PSS,\n   *          'NONE' or null for none, DigestInfo will not be used but\n   *            PKCS#1 v1.5 padding will still be used.\n   *\n   * @return the signature as a byte string.\n   */\n  key.sign = function(md, scheme) {\n    /* Note: The internal implementation of RSA operations is being\n      transitioned away from a PKCS#1 v1.5 hard-coded scheme. Some legacy\n      code like the use of an encoding block identifier 'bt' will eventually\n      be removed. */\n\n    // private key operation\n    var bt = false;\n\n    if(typeof scheme === 'string') {\n      scheme = scheme.toUpperCase();\n    }\n\n    if(scheme === undefined || scheme === 'RSASSA-PKCS1-V1_5') {\n      scheme = {encode: emsaPkcs1v15encode};\n      bt = 0x01;\n    } else if(scheme === 'NONE' || scheme === 'NULL' || scheme === null) {\n      scheme = {encode: function() {return md;}};\n      bt = 0x01;\n    }\n\n    // encode and then encrypt\n    var d = scheme.encode(md, key.n.bitLength());\n    return pki.rsa.encrypt(d, key, bt);\n  };\n\n  return key;\n};\n\n/**\n * Wraps an RSAPrivateKey ASN.1 object in an ASN.1 PrivateKeyInfo object.\n *\n * @param rsaKey the ASN.1 RSAPrivateKey.\n *\n * @return the ASN.1 PrivateKeyInfo.\n */\npki.wrapRsaPrivateKey = function(rsaKey) {\n  // PrivateKeyInfo\n  return asn1.create(asn1.Class.UNIVERSAL, asn1.Type.SEQUENCE, true, [\n    // version (0)\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.INTEGER, false,\n      asn1.integerToDer(0).getBytes()),\n    // privateKeyAlgorithm\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.SEQUENCE, true, [\n      asn1.create(\n        asn1.Class.UNIVERSAL, asn1.Type.OID, false,\n        asn1.oidToDer(pki.oids.rsaEncryption).getBytes()),\n      asn1.create(asn1.Class.UNIVERSAL, asn1.Type.NULL, false, '')\n    ]),\n    // PrivateKey\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.OCTETSTRING, false,\n      asn1.toDer(rsaKey).getBytes())\n  ]);\n};\n\n/**\n * Converts a private key from an ASN.1 object.\n *\n * @param obj the ASN.1 representation of a PrivateKeyInfo containing an\n *          RSAPrivateKey or an RSAPrivateKey.\n *\n * @return the private key.\n */\npki.privateKeyFromAsn1 = function(obj) {\n  // get PrivateKeyInfo\n  var capture = {};\n  var errors = [];\n  if(asn1.validate(obj, privateKeyValidator, capture, errors)) {\n    obj = asn1.fromDer(forge.util.createBuffer(capture.privateKey));\n  }\n\n  // get RSAPrivateKey\n  capture = {};\n  errors = [];\n  if(!asn1.validate(obj, rsaPrivateKeyValidator, capture, errors)) {\n    var error = new Error('Cannot read private key. ' +\n      'ASN.1 object does not contain an RSAPrivateKey.');\n    error.errors = errors;\n    throw error;\n  }\n\n  // Note: Version is currently ignored.\n  // capture.privateKeyVersion\n  // FIXME: inefficient, get a BigInteger that uses byte strings\n  var n, e, d, p, q, dP, dQ, qInv;\n  n = forge.util.createBuffer(capture.privateKeyModulus).toHex();\n  e = forge.util.createBuffer(capture.privateKeyPublicExponent).toHex();\n  d = forge.util.createBuffer(capture.privateKeyPrivateExponent).toHex();\n  p = forge.util.createBuffer(capture.privateKeyPrime1).toHex();\n  q = forge.util.createBuffer(capture.privateKeyPrime2).toHex();\n  dP = forge.util.createBuffer(capture.privateKeyExponent1).toHex();\n  dQ = forge.util.createBuffer(capture.privateKeyExponent2).toHex();\n  qInv = forge.util.createBuffer(capture.privateKeyCoefficient).toHex();\n\n  // set private key\n  return pki.setRsaPrivateKey(\n    new BigInteger(n, 16),\n    new BigInteger(e, 16),\n    new BigInteger(d, 16),\n    new BigInteger(p, 16),\n    new BigInteger(q, 16),\n    new BigInteger(dP, 16),\n    new BigInteger(dQ, 16),\n    new BigInteger(qInv, 16));\n};\n\n/**\n * Converts a private key to an ASN.1 RSAPrivateKey.\n *\n * @param key the private key.\n *\n * @return the ASN.1 representation of an RSAPrivateKey.\n */\npki.privateKeyToAsn1 = pki.privateKeyToRSAPrivateKey = function(key) {\n  // RSAPrivateKey\n  return asn1.create(asn1.Class.UNIVERSAL, asn1.Type.SEQUENCE, true, [\n    // version (0 = only 2 primes, 1 multiple primes)\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.INTEGER, false,\n      asn1.integerToDer(0).getBytes()),\n    // modulus (n)\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.INTEGER, false,\n      _bnToBytes(key.n)),\n    // publicExponent (e)\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.INTEGER, false,\n      _bnToBytes(key.e)),\n    // privateExponent (d)\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.INTEGER, false,\n      _bnToBytes(key.d)),\n    // privateKeyPrime1 (p)\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.INTEGER, false,\n      _bnToBytes(key.p)),\n    // privateKeyPrime2 (q)\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.INTEGER, false,\n      _bnToBytes(key.q)),\n    // privateKeyExponent1 (dP)\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.INTEGER, false,\n      _bnToBytes(key.dP)),\n    // privateKeyExponent2 (dQ)\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.INTEGER, false,\n      _bnToBytes(key.dQ)),\n    // coefficient (qInv)\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.INTEGER, false,\n      _bnToBytes(key.qInv))\n  ]);\n};\n\n/**\n * Converts a public key from an ASN.1 SubjectPublicKeyInfo or RSAPublicKey.\n *\n * @param obj the asn1 representation of a SubjectPublicKeyInfo or RSAPublicKey.\n *\n * @return the public key.\n */\npki.publicKeyFromAsn1 = function(obj) {\n  // get SubjectPublicKeyInfo\n  var capture = {};\n  var errors = [];\n  if(asn1.validate(obj, publicKeyValidator, capture, errors)) {\n    // get oid\n    var oid = asn1.derToOid(capture.publicKeyOid);\n    if(oid !== pki.oids.rsaEncryption) {\n      var error = new Error('Cannot read public key. Unknown OID.');\n      error.oid = oid;\n      throw error;\n    }\n    obj = capture.rsaPublicKey;\n  }\n\n  // get RSA params\n  errors = [];\n  if(!asn1.validate(obj, rsaPublicKeyValidator, capture, errors)) {\n    var error = new Error('Cannot read public key. ' +\n      'ASN.1 object does not contain an RSAPublicKey.');\n    error.errors = errors;\n    throw error;\n  }\n\n  // FIXME: inefficient, get a BigInteger that uses byte strings\n  var n = forge.util.createBuffer(capture.publicKeyModulus).toHex();\n  var e = forge.util.createBuffer(capture.publicKeyExponent).toHex();\n\n  // set public key\n  return pki.setRsaPublicKey(\n    new BigInteger(n, 16),\n    new BigInteger(e, 16));\n};\n\n/**\n * Converts a public key to an ASN.1 SubjectPublicKeyInfo.\n *\n * @param key the public key.\n *\n * @return the asn1 representation of a SubjectPublicKeyInfo.\n */\npki.publicKeyToAsn1 = pki.publicKeyToSubjectPublicKeyInfo = function(key) {\n  // SubjectPublicKeyInfo\n  return asn1.create(asn1.Class.UNIVERSAL, asn1.Type.SEQUENCE, true, [\n    // AlgorithmIdentifier\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.SEQUENCE, true, [\n      // algorithm\n      asn1.create(asn1.Class.UNIVERSAL, asn1.Type.OID, false,\n        asn1.oidToDer(pki.oids.rsaEncryption).getBytes()),\n      // parameters (null)\n      asn1.create(asn1.Class.UNIVERSAL, asn1.Type.NULL, false, '')\n    ]),\n    // subjectPublicKey\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.BITSTRING, false, [\n      pki.publicKeyToRSAPublicKey(key)\n    ])\n  ]);\n};\n\n/**\n * Converts a public key to an ASN.1 RSAPublicKey.\n *\n * @param key the public key.\n *\n * @return the asn1 representation of a RSAPublicKey.\n */\npki.publicKeyToRSAPublicKey = function(key) {\n  // RSAPublicKey\n  return asn1.create(asn1.Class.UNIVERSAL, asn1.Type.SEQUENCE, true, [\n    // modulus (n)\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.INTEGER, false,\n      _bnToBytes(key.n)),\n    // publicExponent (e)\n    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.INTEGER, false,\n      _bnToBytes(key.e))\n  ]);\n};\n\n/**\n * Encodes a message using PKCS#1 v1.5 padding.\n *\n * @param m the message to encode.\n * @param key the RSA key to use.\n * @param bt the block type to use, i.e. either 0x01 (for signing) or 0x02\n *          (for encryption).\n *\n * @return the padded byte buffer.\n */\nfunction _encodePkcs1_v1_5(m, key, bt) {\n  var eb = forge.util.createBuffer();\n\n  // get the length of the modulus in bytes\n  var k = Math.ceil(key.n.bitLength() / 8);\n\n  /* use PKCS#1 v1.5 padding */\n  if(m.length > (k - 11)) {\n    var error = new Error('Message is too long for PKCS#1 v1.5 padding.');\n    error.length = m.length;\n    error.max = k - 11;\n    throw error;\n  }\n\n  /* A block type BT, a padding string PS, and the data D shall be\n    formatted into an octet string EB, the encryption block:\n\n    EB = 00 || BT || PS || 00 || D\n\n    The block type BT shall be a single octet indicating the structure of\n    the encryption block. For this version of the document it shall have\n    value 00, 01, or 02. For a private-key operation, the block type\n    shall be 00 or 01. For a public-key operation, it shall be 02.\n\n    The padding string PS shall consist of k-3-||D|| octets. For block\n    type 00, the octets shall have value 00; for block type 01, they\n    shall have value FF; and for block type 02, they shall be\n    pseudorandomly generated and nonzero. This makes the length of the\n    encryption block EB equal to k. */\n\n  // build the encryption block\n  eb.putByte(0x00);\n  eb.putByte(bt);\n\n  // create the padding\n  var padNum = k - 3 - m.length;\n  var padByte;\n  // private key op\n  if(bt === 0x00 || bt === 0x01) {\n    padByte = (bt === 0x00) ? 0x00 : 0xFF;\n    for(var i = 0; i < padNum; ++i) {\n      eb.putByte(padByte);\n    }\n  } else {\n    // public key op\n    // pad with random non-zero values\n    while(padNum > 0) {\n      var numZeros = 0;\n      var padBytes = forge.random.getBytes(padNum);\n      for(var i = 0; i < padNum; ++i) {\n        padByte = padBytes.charCodeAt(i);\n        if(padByte === 0) {\n          ++numZeros;\n        } else {\n          eb.putByte(padByte);\n        }\n      }\n      padNum = numZeros;\n    }\n  }\n\n  // zero followed by message\n  eb.putByte(0x00);\n  eb.putBytes(m);\n\n  return eb;\n}\n\n/**\n * Decodes a message using PKCS#1 v1.5 padding.\n *\n * @param em the message to decode.\n * @param key the RSA key to use.\n * @param pub true if the key is a public key, false if it is private.\n * @param ml the message length, if specified.\n *\n * @return the decoded bytes.\n */\nfunction _decodePkcs1_v1_5(em, key, pub, ml) {\n  // get the length of the modulus in bytes\n  var k = Math.ceil(key.n.bitLength() / 8);\n\n  /* It is an error if any of the following conditions occurs:\n\n    1. The encryption block EB cannot be parsed unambiguously.\n    2. The padding string PS consists of fewer than eight octets\n      or is inconsisent with the block type BT.\n    3. The decryption process is a public-key operation and the block\n      type BT is not 00 or 01, or the decryption process is a\n      private-key operation and the block type is not 02.\n   */\n\n  // parse the encryption block\n  var eb = forge.util.createBuffer(em);\n  var first = eb.getByte();\n  var bt = eb.getByte();\n  if(first !== 0x00 ||\n    (pub && bt !== 0x00 && bt !== 0x01) ||\n    (!pub && bt != 0x02) ||\n    (pub && bt === 0x00 && typeof(ml) === 'undefined')) {\n    throw new Error('Encryption block is invalid.');\n  }\n\n  var padNum = 0;\n  if(bt === 0x00) {\n    // check all padding bytes for 0x00\n    padNum = k - 3 - ml;\n    for(var i = 0; i < padNum; ++i) {\n      if(eb.getByte() !== 0x00) {\n        throw new Error('Encryption block is invalid.');\n      }\n    }\n  } else if(bt === 0x01) {\n    // find the first byte that isn't 0xFF, should be after all padding\n    padNum = 0;\n    while(eb.length() > 1) {\n      if(eb.getByte() !== 0xFF) {\n        --eb.read;\n        break;\n      }\n      ++padNum;\n    }\n  } else if(bt === 0x02) {\n    // look for 0x00 byte\n    padNum = 0;\n    while(eb.length() > 1) {\n      if(eb.getByte() === 0x00) {\n        --eb.read;\n        break;\n      }\n      ++padNum;\n    }\n  }\n\n  // zero must be 0x00 and padNum must be (k - 3 - message length)\n  var zero = eb.getByte();\n  if(zero !== 0x00 || padNum !== (k - 3 - eb.length())) {\n    throw new Error('Encryption block is invalid.');\n  }\n\n  return eb.getBytes();\n}\n\n/**\n * Runs the key-generation algorithm asynchronously, either in the background\n * via Web Workers, or using the main thread and setImmediate.\n *\n * @param state the key-pair generation state.\n * @param [options] options for key-pair generation:\n *          workerScript the worker script URL.\n *          workers the number of web workers (if supported) to use,\n *            (default: 2, -1 to use estimated cores minus one).\n *          workLoad the size of the work load, ie: number of possible prime\n *            numbers for each web worker to check per work assignment,\n *            (default: 100).\n * @param callback(err, keypair) called once the operation completes.\n */\nfunction _generateKeyPair(state, options, callback) {\n  if(typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n  options = options || {};\n\n  var opts = {\n    algorithm: {\n      name: options.algorithm || 'PRIMEINC',\n      options: {\n        workers: options.workers || 2,\n        workLoad: options.workLoad || 100,\n        workerScript: options.workerScript\n      }\n    }\n  };\n  if('prng' in options) {\n    opts.prng = options.prng;\n  }\n\n  generate();\n\n  function generate() {\n    // find p and then q (done in series to simplify)\n    getPrime(state.pBits, function(err, num) {\n      if(err) {\n        return callback(err);\n      }\n      state.p = num;\n      if(state.q !== null) {\n        return finish(err, state.q);\n      }\n      getPrime(state.qBits, finish);\n    });\n  }\n\n  function getPrime(bits, callback) {\n    forge.prime.generateProbablePrime(bits, opts, callback);\n  }\n\n  function finish(err, num) {\n    if(err) {\n      return callback(err);\n    }\n\n    // set q\n    state.q = num;\n\n    // ensure p is larger than q (swap them if not)\n    if(state.p.compareTo(state.q) < 0) {\n      var tmp = state.p;\n      state.p = state.q;\n      state.q = tmp;\n    }\n\n    // ensure p is coprime with e\n    if(state.p.subtract(BigInteger.ONE).gcd(state.e)\n      .compareTo(BigInteger.ONE) !== 0) {\n      state.p = null;\n      generate();\n      return;\n    }\n\n    // ensure q is coprime with e\n    if(state.q.subtract(BigInteger.ONE).gcd(state.e)\n      .compareTo(BigInteger.ONE) !== 0) {\n      state.q = null;\n      getPrime(state.qBits, finish);\n      return;\n    }\n\n    // compute phi: (p - 1)(q - 1) (Euler's totient function)\n    state.p1 = state.p.subtract(BigInteger.ONE);\n    state.q1 = state.q.subtract(BigInteger.ONE);\n    state.phi = state.p1.multiply(state.q1);\n\n    // ensure e and phi are coprime\n    if(state.phi.gcd(state.e).compareTo(BigInteger.ONE) !== 0) {\n      // phi and e aren't coprime, so generate a new p and q\n      state.p = state.q = null;\n      generate();\n      return;\n    }\n\n    // create n, ensure n is has the right number of bits\n    state.n = state.p.multiply(state.q);\n    if(state.n.bitLength() !== state.bits) {\n      // failed, get new q\n      state.q = null;\n      getPrime(state.qBits, finish);\n      return;\n    }\n\n    // set keys\n    var d = state.e.modInverse(state.phi);\n    state.keys = {\n      privateKey: pki.rsa.setPrivateKey(\n        state.n, state.e, d, state.p, state.q,\n        d.mod(state.p1), d.mod(state.q1),\n        state.q.modInverse(state.p)),\n      publicKey: pki.rsa.setPublicKey(state.n, state.e)\n    };\n\n    callback(null, state.keys);\n  }\n}\n\n/**\n * Converts a positive BigInteger into 2's-complement big-endian bytes.\n *\n * @param b the big integer to convert.\n *\n * @return the bytes.\n */\nfunction _bnToBytes(b) {\n  // prepend 0x00 if first byte >= 0x80\n  var hex = b.toString(16);\n  if(hex[0] >= '8') {\n    hex = '00' + hex;\n  }\n  var bytes = forge.util.hexToBytes(hex);\n\n  // ensure integer is minimally-encoded\n  if(bytes.length > 1 &&\n    // leading 0x00 for positive integer\n    ((bytes.charCodeAt(0) === 0 &&\n    (bytes.charCodeAt(1) & 0x80) === 0) ||\n    // leading 0xFF for negative integer\n    (bytes.charCodeAt(0) === 0xFF &&\n    (bytes.charCodeAt(1) & 0x80) === 0x80))) {\n    return bytes.substr(1);\n  }\n  return bytes;\n}\n\n/**\n * Returns the required number of Miller-Rabin tests to generate a\n * prime with an error probability of (1/2)^80.\n *\n * See Handbook of Applied Cryptography Chapter 4, Table 4.4.\n *\n * @param bits the bit size.\n *\n * @return the required number of iterations.\n */\nfunction _getMillerRabinTests(bits) {\n  if(bits <= 100) return 27;\n  if(bits <= 150) return 18;\n  if(bits <= 200) return 15;\n  if(bits <= 250) return 12;\n  if(bits <= 300) return 9;\n  if(bits <= 350) return 8;\n  if(bits <= 400) return 7;\n  if(bits <= 500) return 6;\n  if(bits <= 600) return 5;\n  if(bits <= 800) return 4;\n  if(bits <= 1250) return 3;\n  return 2;\n}\n\n/**\n * Performs feature detection on the Node crypto interface.\n *\n * @param fn the feature (function) to detect.\n *\n * @return true if detected, false if not.\n */\nfunction _detectNodeCrypto(fn) {\n  return forge.util.isNodejs && typeof _crypto[fn] === 'function';\n}\n\n/**\n * Performs feature detection on the SubtleCrypto interface.\n *\n * @param fn the feature (function) to detect.\n *\n * @return true if detected, false if not.\n */\nfunction _detectSubtleCrypto(fn) {\n  return (typeof util.globalScope !== 'undefined' &&\n    typeof util.globalScope.crypto === 'object' &&\n    typeof util.globalScope.crypto.subtle === 'object' &&\n    typeof util.globalScope.crypto.subtle[fn] === 'function');\n}\n\n/**\n * Performs feature detection on the deprecated Microsoft Internet Explorer\n * outdated SubtleCrypto interface. This function should only be used after\n * checking for the modern, standard SubtleCrypto interface.\n *\n * @param fn the feature (function) to detect.\n *\n * @return true if detected, false if not.\n */\nfunction _detectSubtleMsCrypto(fn) {\n  return (typeof util.globalScope !== 'undefined' &&\n    typeof util.globalScope.msCrypto === 'object' &&\n    typeof util.globalScope.msCrypto.subtle === 'object' &&\n    typeof util.globalScope.msCrypto.subtle[fn] === 'function');\n}\n\nfunction _intToUint8Array(x) {\n  var bytes = forge.util.hexToBytes(x.toString(16));\n  var buffer = new Uint8Array(bytes.length);\n  for(var i = 0; i < bytes.length; ++i) {\n    buffer[i] = bytes.charCodeAt(i);\n  }\n  return buffer;\n}\n\nfunction _privateKeyFromJwk(jwk) {\n  if(jwk.kty !== 'RSA') {\n    throw new Error(\n      'Unsupported key algorithm \"' + jwk.kty + '\"; algorithm must be \"RSA\".');\n  }\n  return pki.setRsaPrivateKey(\n    _base64ToBigInt(jwk.n),\n    _base64ToBigInt(jwk.e),\n    _base64ToBigInt(jwk.d),\n    _base64ToBigInt(jwk.p),\n    _base64ToBigInt(jwk.q),\n    _base64ToBigInt(jwk.dp),\n    _base64ToBigInt(jwk.dq),\n    _base64ToBigInt(jwk.qi));\n}\n\nfunction _publicKeyFromJwk(jwk) {\n  if(jwk.kty !== 'RSA') {\n    throw new Error('Key algorithm must be \"RSA\".');\n  }\n  return pki.setRsaPublicKey(\n    _base64ToBigInt(jwk.n),\n    _base64ToBigInt(jwk.e));\n}\n\nfunction _base64ToBigInt(b64) {\n  return new BigInteger(forge.util.bytesToHex(forge.util.decode64(b64)), 16);\n}\n","/**\n * Javascript implementation of PKCS#1 PSS signature padding.\n *\n * @author Stefan Siegl\n *\n * Copyright (c) 2012 Stefan Siegl <stesie@brokenpipe.de>\n */\nvar forge = require('./forge');\nrequire('./random');\nrequire('./util');\n\n// shortcut for PSS API\nvar pss = module.exports = forge.pss = forge.pss || {};\n\n/**\n * Creates a PSS signature scheme object.\n *\n * There are several ways to provide a salt for encoding:\n *\n * 1. Specify the saltLength only and the built-in PRNG will generate it.\n * 2. Specify the saltLength and a custom PRNG with 'getBytesSync' defined that\n *   will be used.\n * 3. Specify the salt itself as a forge.util.ByteBuffer.\n *\n * @param options the options to use:\n *          md the message digest object to use, a forge md instance.\n *          mgf the mask generation function to use, a forge mgf instance.\n *          [saltLength] the length of the salt in octets.\n *          [prng] the pseudo-random number generator to use to produce a salt.\n *          [salt] the salt to use when encoding.\n *\n * @return a signature scheme object.\n */\npss.create = function(options) {\n  // backwards compatibility w/legacy args: hash, mgf, sLen\n  if(arguments.length === 3) {\n    options = {\n      md: arguments[0],\n      mgf: arguments[1],\n      saltLength: arguments[2]\n    };\n  }\n\n  var hash = options.md;\n  var mgf = options.mgf;\n  var hLen = hash.digestLength;\n\n  var salt_ = options.salt || null;\n  if(typeof salt_ === 'string') {\n    // assume binary-encoded string\n    salt_ = forge.util.createBuffer(salt_);\n  }\n\n  var sLen;\n  if('saltLength' in options) {\n    sLen = options.saltLength;\n  } else if(salt_ !== null) {\n    sLen = salt_.length();\n  } else {\n    throw new Error('Salt length not specified or specific salt not given.');\n  }\n\n  if(salt_ !== null && salt_.length() !== sLen) {\n    throw new Error('Given salt length does not match length of given salt.');\n  }\n\n  var prng = options.prng || forge.random;\n\n  var pssobj = {};\n\n  /**\n   * Encodes a PSS signature.\n   *\n   * This function implements EMSA-PSS-ENCODE as per RFC 3447, section 9.1.1.\n   *\n   * @param md the message digest object with the hash to sign.\n   * @param modsBits the length of the RSA modulus in bits.\n   *\n   * @return the encoded message as a binary-encoded string of length\n   *           ceil((modBits - 1) / 8).\n   */\n  pssobj.encode = function(md, modBits) {\n    var i;\n    var emBits = modBits - 1;\n    var emLen = Math.ceil(emBits / 8);\n\n    /* 2. Let mHash = Hash(M), an octet string of length hLen. */\n    var mHash = md.digest().getBytes();\n\n    /* 3. If emLen < hLen + sLen + 2, output \"encoding error\" and stop. */\n    if(emLen < hLen + sLen + 2) {\n      throw new Error('Message is too long to encrypt.');\n    }\n\n    /* 4. Generate a random octet string salt of length sLen; if sLen = 0,\n     *    then salt is the empty string. */\n    var salt;\n    if(salt_ === null) {\n      salt = prng.getBytesSync(sLen);\n    } else {\n      salt = salt_.bytes();\n    }\n\n    /* 5. Let M' = (0x)00 00 00 00 00 00 00 00 || mHash || salt; */\n    var m_ = new forge.util.ByteBuffer();\n    m_.fillWithByte(0, 8);\n    m_.putBytes(mHash);\n    m_.putBytes(salt);\n\n    /* 6. Let H = Hash(M'), an octet string of length hLen. */\n    hash.start();\n    hash.update(m_.getBytes());\n    var h = hash.digest().getBytes();\n\n    /* 7. Generate an octet string PS consisting of emLen - sLen - hLen - 2\n     *    zero octets.  The length of PS may be 0. */\n    var ps = new forge.util.ByteBuffer();\n    ps.fillWithByte(0, emLen - sLen - hLen - 2);\n\n    /* 8. Let DB = PS || 0x01 || salt; DB is an octet string of length\n     *    emLen - hLen - 1. */\n    ps.putByte(0x01);\n    ps.putBytes(salt);\n    var db = ps.getBytes();\n\n    /* 9. Let dbMask = MGF(H, emLen - hLen - 1). */\n    var maskLen = emLen - hLen - 1;\n    var dbMask = mgf.generate(h, maskLen);\n\n    /* 10. Let maskedDB = DB \\xor dbMask. */\n    var maskedDB = '';\n    for(i = 0; i < maskLen; i++) {\n      maskedDB += String.fromCharCode(db.charCodeAt(i) ^ dbMask.charCodeAt(i));\n    }\n\n    /* 11. Set the leftmost 8emLen - emBits bits of the leftmost octet in\n     *     maskedDB to zero. */\n    var mask = (0xFF00 >> (8 * emLen - emBits)) & 0xFF;\n    maskedDB = String.fromCharCode(maskedDB.charCodeAt(0) & ~mask) +\n      maskedDB.substr(1);\n\n    /* 12. Let EM = maskedDB || H || 0xbc.\n     * 13. Output EM. */\n    return maskedDB + h + String.fromCharCode(0xbc);\n  };\n\n  /**\n   * Verifies a PSS signature.\n   *\n   * This function implements EMSA-PSS-VERIFY as per RFC 3447, section 9.1.2.\n   *\n   * @param mHash the message digest hash, as a binary-encoded string, to\n   *         compare against the signature.\n   * @param em the encoded message, as a binary-encoded string\n   *          (RSA decryption result).\n   * @param modsBits the length of the RSA modulus in bits.\n   *\n   * @return true if the signature was verified, false if not.\n   */\n  pssobj.verify = function(mHash, em, modBits) {\n    var i;\n    var emBits = modBits - 1;\n    var emLen = Math.ceil(emBits / 8);\n\n    /* c. Convert the message representative m to an encoded message EM\n     *    of length emLen = ceil((modBits - 1) / 8) octets, where modBits\n     *    is the length in bits of the RSA modulus n */\n    em = em.substr(-emLen);\n\n    /* 3. If emLen < hLen + sLen + 2, output \"inconsistent\" and stop. */\n    if(emLen < hLen + sLen + 2) {\n      throw new Error('Inconsistent parameters to PSS signature verification.');\n    }\n\n    /* 4. If the rightmost octet of EM does not have hexadecimal value\n     *    0xbc, output \"inconsistent\" and stop. */\n    if(em.charCodeAt(emLen - 1) !== 0xbc) {\n      throw new Error('Encoded message does not end in 0xBC.');\n    }\n\n    /* 5. Let maskedDB be the leftmost emLen - hLen - 1 octets of EM, and\n     *    let H be the next hLen octets. */\n    var maskLen = emLen - hLen - 1;\n    var maskedDB = em.substr(0, maskLen);\n    var h = em.substr(maskLen, hLen);\n\n    /* 6. If the leftmost 8emLen - emBits bits of the leftmost octet in\n     *    maskedDB are not all equal to zero, output \"inconsistent\" and stop. */\n    var mask = (0xFF00 >> (8 * emLen - emBits)) & 0xFF;\n    if((maskedDB.charCodeAt(0) & mask) !== 0) {\n      throw new Error('Bits beyond keysize not zero as expected.');\n    }\n\n    /* 7. Let dbMask = MGF(H, emLen - hLen - 1). */\n    var dbMask = mgf.generate(h, maskLen);\n\n    /* 8. Let DB = maskedDB \\xor dbMask. */\n    var db = '';\n    for(i = 0; i < maskLen; i++) {\n      db += String.fromCharCode(maskedDB.charCodeAt(i) ^ dbMask.charCodeAt(i));\n    }\n\n    /* 9. Set the leftmost 8emLen - emBits bits of the leftmost octet\n     * in DB to zero. */\n    db = String.fromCharCode(db.charCodeAt(0) & ~mask) + db.substr(1);\n\n    /* 10. If the emLen - hLen - sLen - 2 leftmost octets of DB are not zero\n     * or if the octet at position emLen - hLen - sLen - 1 (the leftmost\n     * position is \"position 1\") does not have hexadecimal value 0x01,\n     * output \"inconsistent\" and stop. */\n    var checkLen = emLen - hLen - sLen - 2;\n    for(i = 0; i < checkLen; i++) {\n      if(db.charCodeAt(i) !== 0x00) {\n        throw new Error('Leftmost octets not zero as expected');\n      }\n    }\n\n    if(db.charCodeAt(checkLen) !== 0x01) {\n      throw new Error('Inconsistent PSS signature, 0x01 marker not found');\n    }\n\n    /* 11. Let salt be the last sLen octets of DB. */\n    var salt = db.substr(-sLen);\n\n    /* 12.  Let M' = (0x)00 00 00 00 00 00 00 00 || mHash || salt */\n    var m_ = new forge.util.ByteBuffer();\n    m_.fillWithByte(0, 8);\n    m_.putBytes(mHash);\n    m_.putBytes(salt);\n\n    /* 13. Let H' = Hash(M'), an octet string of length hLen. */\n    hash.start();\n    hash.update(m_.getBytes());\n    var h_ = hash.digest().getBytes();\n\n    /* 14. If H = H', output \"consistent.\" Otherwise, output \"inconsistent.\" */\n    return h === h_;\n  };\n\n  return pssobj;\n};\n","/**\n * RC2 implementation.\n *\n * @author Stefan Siegl\n *\n * Copyright (c) 2012 Stefan Siegl <stesie@brokenpipe.de>\n *\n * Information on the RC2 cipher is available from RFC #2268,\n * http://www.ietf.org/rfc/rfc2268.txt\n */\nvar forge = require('./forge');\nrequire('./util');\n\nvar piTable = [\n  0xd9, 0x78, 0xf9, 0xc4, 0x19, 0xdd, 0xb5, 0xed, 0x28, 0xe9, 0xfd, 0x79, 0x4a, 0xa0, 0xd8, 0x9d,\n  0xc6, 0x7e, 0x37, 0x83, 0x2b, 0x76, 0x53, 0x8e, 0x62, 0x4c, 0x64, 0x88, 0x44, 0x8b, 0xfb, 0xa2,\n  0x17, 0x9a, 0x59, 0xf5, 0x87, 0xb3, 0x4f, 0x13, 0x61, 0x45, 0x6d, 0x8d, 0x09, 0x81, 0x7d, 0x32,\n  0xbd, 0x8f, 0x40, 0xeb, 0x86, 0xb7, 0x7b, 0x0b, 0xf0, 0x95, 0x21, 0x22, 0x5c, 0x6b, 0x4e, 0x82,\n  0x54, 0xd6, 0x65, 0x93, 0xce, 0x60, 0xb2, 0x1c, 0x73, 0x56, 0xc0, 0x14, 0xa7, 0x8c, 0xf1, 0xdc,\n  0x12, 0x75, 0xca, 0x1f, 0x3b, 0xbe, 0xe4, 0xd1, 0x42, 0x3d, 0xd4, 0x30, 0xa3, 0x3c, 0xb6, 0x26,\n  0x6f, 0xbf, 0x0e, 0xda, 0x46, 0x69, 0x07, 0x57, 0x27, 0xf2, 0x1d, 0x9b, 0xbc, 0x94, 0x43, 0x03,\n  0xf8, 0x11, 0xc7, 0xf6, 0x90, 0xef, 0x3e, 0xe7, 0x06, 0xc3, 0xd5, 0x2f, 0xc8, 0x66, 0x1e, 0xd7,\n  0x08, 0xe8, 0xea, 0xde, 0x80, 0x52, 0xee, 0xf7, 0x84, 0xaa, 0x72, 0xac, 0x35, 0x4d, 0x6a, 0x2a,\n  0x96, 0x1a, 0xd2, 0x71, 0x5a, 0x15, 0x49, 0x74, 0x4b, 0x9f, 0xd0, 0x5e, 0x04, 0x18, 0xa4, 0xec,\n  0xc2, 0xe0, 0x41, 0x6e, 0x0f, 0x51, 0xcb, 0xcc, 0x24, 0x91, 0xaf, 0x50, 0xa1, 0xf4, 0x70, 0x39,\n  0x99, 0x7c, 0x3a, 0x85, 0x23, 0xb8, 0xb4, 0x7a, 0xfc, 0x02, 0x36, 0x5b, 0x25, 0x55, 0x97, 0x31,\n  0x2d, 0x5d, 0xfa, 0x98, 0xe3, 0x8a, 0x92, 0xae, 0x05, 0xdf, 0x29, 0x10, 0x67, 0x6c, 0xba, 0xc9,\n  0xd3, 0x00, 0xe6, 0xcf, 0xe1, 0x9e, 0xa8, 0x2c, 0x63, 0x16, 0x01, 0x3f, 0x58, 0xe2, 0x89, 0xa9,\n  0x0d, 0x38, 0x34, 0x1b, 0xab, 0x33, 0xff, 0xb0, 0xbb, 0x48, 0x0c, 0x5f, 0xb9, 0xb1, 0xcd, 0x2e,\n  0xc5, 0xf3, 0xdb, 0x47, 0xe5, 0xa5, 0x9c, 0x77, 0x0a, 0xa6, 0x20, 0x68, 0xfe, 0x7f, 0xc1, 0xad\n];\n\nvar s = [1, 2, 3, 5];\n\n/**\n * Rotate a word left by given number of bits.\n *\n * Bits that are shifted out on the left are put back in on the right\n * hand side.\n *\n * @param word The word to shift left.\n * @param bits The number of bits to shift by.\n * @return The rotated word.\n */\nvar rol = function(word, bits) {\n  return ((word << bits) & 0xffff) | ((word & 0xffff) >> (16 - bits));\n};\n\n/**\n * Rotate a word right by given number of bits.\n *\n * Bits that are shifted out on the right are put back in on the left\n * hand side.\n *\n * @param word The word to shift right.\n * @param bits The number of bits to shift by.\n * @return The rotated word.\n */\nvar ror = function(word, bits) {\n  return ((word & 0xffff) >> bits) | ((word << (16 - bits)) & 0xffff);\n};\n\n/* RC2 API */\nmodule.exports = forge.rc2 = forge.rc2 || {};\n\n/**\n * Perform RC2 key expansion as per RFC #2268, section 2.\n *\n * @param key variable-length user key (between 1 and 128 bytes)\n * @param effKeyBits number of effective key bits (default: 128)\n * @return the expanded RC2 key (ByteBuffer of 128 bytes)\n */\nforge.rc2.expandKey = function(key, effKeyBits) {\n  if(typeof key === 'string') {\n    key = forge.util.createBuffer(key);\n  }\n  effKeyBits = effKeyBits || 128;\n\n  /* introduce variables that match the names used in RFC #2268 */\n  var L = key;\n  var T = key.length();\n  var T1 = effKeyBits;\n  var T8 = Math.ceil(T1 / 8);\n  var TM = 0xff >> (T1 & 0x07);\n  var i;\n\n  for(i = T; i < 128; i++) {\n    L.putByte(piTable[(L.at(i - 1) + L.at(i - T)) & 0xff]);\n  }\n\n  L.setAt(128 - T8, piTable[L.at(128 - T8) & TM]);\n\n  for(i = 127 - T8; i >= 0; i--) {\n    L.setAt(i, piTable[L.at(i + 1) ^ L.at(i + T8)]);\n  }\n\n  return L;\n};\n\n/**\n * Creates a RC2 cipher object.\n *\n * @param key the symmetric key to use (as base for key generation).\n * @param bits the number of effective key bits.\n * @param encrypt false for decryption, true for encryption.\n *\n * @return the cipher.\n */\nvar createCipher = function(key, bits, encrypt) {\n  var _finish = false, _input = null, _output = null, _iv = null;\n  var mixRound, mashRound;\n  var i, j, K = [];\n\n  /* Expand key and fill into K[] Array */\n  key = forge.rc2.expandKey(key, bits);\n  for(i = 0; i < 64; i++) {\n    K.push(key.getInt16Le());\n  }\n\n  if(encrypt) {\n    /**\n     * Perform one mixing round \"in place\".\n     *\n     * @param R Array of four words to perform mixing on.\n     */\n    mixRound = function(R) {\n      for(i = 0; i < 4; i++) {\n        R[i] += K[j] + (R[(i + 3) % 4] & R[(i + 2) % 4]) +\n          ((~R[(i + 3) % 4]) & R[(i + 1) % 4]);\n        R[i] = rol(R[i], s[i]);\n        j++;\n      }\n    };\n\n    /**\n     * Perform one mashing round \"in place\".\n     *\n     * @param R Array of four words to perform mashing on.\n     */\n    mashRound = function(R) {\n      for(i = 0; i < 4; i++) {\n        R[i] += K[R[(i + 3) % 4] & 63];\n      }\n    };\n  } else {\n    /**\n     * Perform one r-mixing round \"in place\".\n     *\n     * @param R Array of four words to perform mixing on.\n     */\n    mixRound = function(R) {\n      for(i = 3; i >= 0; i--) {\n        R[i] = ror(R[i], s[i]);\n        R[i] -= K[j] + (R[(i + 3) % 4] & R[(i + 2) % 4]) +\n          ((~R[(i + 3) % 4]) & R[(i + 1) % 4]);\n        j--;\n      }\n    };\n\n    /**\n     * Perform one r-mashing round \"in place\".\n     *\n     * @param R Array of four words to perform mashing on.\n     */\n    mashRound = function(R) {\n      for(i = 3; i >= 0; i--) {\n        R[i] -= K[R[(i + 3) % 4] & 63];\n      }\n    };\n  }\n\n  /**\n   * Run the specified cipher execution plan.\n   *\n   * This function takes four words from the input buffer, applies the IV on\n   * it (if requested) and runs the provided execution plan.\n   *\n   * The plan must be put together in form of a array of arrays.  Where the\n   * outer one is simply a list of steps to perform and the inner one needs\n   * to have two elements: the first one telling how many rounds to perform,\n   * the second one telling what to do (i.e. the function to call).\n   *\n   * @param {Array} plan The plan to execute.\n   */\n  var runPlan = function(plan) {\n    var R = [];\n\n    /* Get data from input buffer and fill the four words into R */\n    for(i = 0; i < 4; i++) {\n      var val = _input.getInt16Le();\n\n      if(_iv !== null) {\n        if(encrypt) {\n          /* We're encrypting, apply the IV first. */\n          val ^= _iv.getInt16Le();\n        } else {\n          /* We're decryption, keep cipher text for next block. */\n          _iv.putInt16Le(val);\n        }\n      }\n\n      R.push(val & 0xffff);\n    }\n\n    /* Reset global \"j\" variable as per spec. */\n    j = encrypt ? 0 : 63;\n\n    /* Run execution plan. */\n    for(var ptr = 0; ptr < plan.length; ptr++) {\n      for(var ctr = 0; ctr < plan[ptr][0]; ctr++) {\n        plan[ptr][1](R);\n      }\n    }\n\n    /* Write back result to output buffer. */\n    for(i = 0; i < 4; i++) {\n      if(_iv !== null) {\n        if(encrypt) {\n          /* We're encrypting in CBC-mode, feed back encrypted bytes into\n             IV buffer to carry it forward to next block. */\n          _iv.putInt16Le(R[i]);\n        } else {\n          R[i] ^= _iv.getInt16Le();\n        }\n      }\n\n      _output.putInt16Le(R[i]);\n    }\n  };\n\n  /* Create cipher object */\n  var cipher = null;\n  cipher = {\n    /**\n     * Starts or restarts the encryption or decryption process, whichever\n     * was previously configured.\n     *\n     * To use the cipher in CBC mode, iv may be given either as a string\n     * of bytes, or as a byte buffer.  For ECB mode, give null as iv.\n     *\n     * @param iv the initialization vector to use, null for ECB mode.\n     * @param output the output the buffer to write to, null to create one.\n     */\n    start: function(iv, output) {\n      if(iv) {\n        /* CBC mode */\n        if(typeof iv === 'string') {\n          iv = forge.util.createBuffer(iv);\n        }\n      }\n\n      _finish = false;\n      _input = forge.util.createBuffer();\n      _output = output || new forge.util.createBuffer();\n      _iv = iv;\n\n      cipher.output = _output;\n    },\n\n    /**\n     * Updates the next block.\n     *\n     * @param input the buffer to read from.\n     */\n    update: function(input) {\n      if(!_finish) {\n        // not finishing, so fill the input buffer with more input\n        _input.putBuffer(input);\n      }\n\n      while(_input.length() >= 8) {\n        runPlan([\n            [ 5, mixRound ],\n            [ 1, mashRound ],\n            [ 6, mixRound ],\n            [ 1, mashRound ],\n            [ 5, mixRound ]\n          ]);\n      }\n    },\n\n    /**\n     * Finishes encrypting or decrypting.\n     *\n     * @param pad a padding function to use, null for PKCS#7 padding,\n     *           signature(blockSize, buffer, decrypt).\n     *\n     * @return true if successful, false on error.\n     */\n    finish: function(pad) {\n      var rval = true;\n\n      if(encrypt) {\n        if(pad) {\n          rval = pad(8, _input, !encrypt);\n        } else {\n          // add PKCS#7 padding to block (each pad byte is the\n          // value of the number of pad bytes)\n          var padding = (_input.length() === 8) ? 8 : (8 - _input.length());\n          _input.fillWithByte(padding, padding);\n        }\n      }\n\n      if(rval) {\n        // do final update\n        _finish = true;\n        cipher.update();\n      }\n\n      if(!encrypt) {\n        // check for error: input data not a multiple of block size\n        rval = (_input.length() === 0);\n        if(rval) {\n          if(pad) {\n            rval = pad(8, _output, !encrypt);\n          } else {\n            // ensure padding byte count is valid\n            var len = _output.length();\n            var count = _output.at(len - 1);\n\n            if(count > len) {\n              rval = false;\n            } else {\n              // trim off padding bytes\n              _output.truncate(count);\n            }\n          }\n        }\n      }\n\n      return rval;\n    }\n  };\n\n  return cipher;\n};\n\n/**\n * Creates an RC2 cipher object to encrypt data in ECB or CBC mode using the\n * given symmetric key. The output will be stored in the 'output' member\n * of the returned cipher.\n *\n * The key and iv may be given as a string of bytes or a byte buffer.\n * The cipher is initialized to use 128 effective key bits.\n *\n * @param key the symmetric key to use.\n * @param iv the initialization vector to use.\n * @param output the buffer to write to, null to create one.\n *\n * @return the cipher.\n */\nforge.rc2.startEncrypting = function(key, iv, output) {\n  var cipher = forge.rc2.createEncryptionCipher(key, 128);\n  cipher.start(iv, output);\n  return cipher;\n};\n\n/**\n * Creates an RC2 cipher object to encrypt data in ECB or CBC mode using the\n * given symmetric key.\n *\n * The key may be given as a string of bytes or a byte buffer.\n *\n * To start encrypting call start() on the cipher with an iv and optional\n * output buffer.\n *\n * @param key the symmetric key to use.\n *\n * @return the cipher.\n */\nforge.rc2.createEncryptionCipher = function(key, bits) {\n  return createCipher(key, bits, true);\n};\n\n/**\n * Creates an RC2 cipher object to decrypt data in ECB or CBC mode using the\n * given symmetric key. The output will be stored in the 'output' member\n * of the returned cipher.\n *\n * The key and iv may be given as a string of bytes or a byte buffer.\n * The cipher is initialized to use 128 effective key bits.\n *\n * @param key the symmetric key to use.\n * @param iv the initialization vector to use.\n * @param output the buffer to write to, null to create one.\n *\n * @return the cipher.\n */\nforge.rc2.startDecrypting = function(key, iv, output) {\n  var cipher = forge.rc2.createDecryptionCipher(key, 128);\n  cipher.start(iv, output);\n  return cipher;\n};\n\n/**\n * Creates an RC2 cipher object to decrypt data in ECB or CBC mode using the\n * given symmetric key.\n *\n * The key may be given as a string of bytes or a byte buffer.\n *\n * To start decrypting call start() on the cipher with an iv and optional\n * output buffer.\n *\n * @param key the symmetric key to use.\n *\n * @return the cipher.\n */\nforge.rc2.createDecryptionCipher = function(key, bits) {\n  return createCipher(key, bits, false);\n};\n"],"sourceRoot":""}